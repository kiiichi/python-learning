function() if (aura_env.LastUpdate and (aura_env.LastUpdate>(GetTime() -aura_env.config['UpdateFrequency']))) then return;end aura_env.LastUpdate=GetTime();local v2=GetTime();local v3=aura_env.OffCooldown;local v4=aura_env.OffCooldownNotCasting;local v5=aura_env.GetRemainingAuraDuration;local v6=aura_env.GetRemainingDebuffDuration;local v7=aura_env.GetRemainingSpellCooldown;local v8=aura_env.IsCasting;local v9=aura_env.GetPlayerStacks;local v10=aura_env.GetTargetStacks;local v11=aura_env.PlayerHasBuff;local v12=aura_env.TargetHasDebuff;local v13=aura_env.HasBloodlust;local v14=aura_env.GetSpellChargesFractional;local v15=aura_env.GetTimeToNextCharge;local v16=aura_env.GetTimeToFullCharges;local v17=aura_env.TargetTimeToXPct;local v18=aura_env.FightRemains;local v19=aura_env.IsAuraRefreshable;local v20=aura_env.KTrig;local v21=aura_env.KTrigCD;local v22=aura_env.KTrigTinyCD;aura_env.FlagKTrigCD=true;local v24=aura_env.FullGCD;local v25=aura_env.ids;aura_env.OutOfRange=false;local v27={};local v28=WeakAuras.GetNumSetItemsEquipped(3168 -(13 + 1224) );local v29=UnitPower("player",Enum.PowerType.Rage);local v30=UnitPowerMax("player",Enum.PowerType.Rage);local v31=791 -(368 + 423) ;local v32=78 -53 ;for v40=1,58 -(10 + 8)  do local v41=0 -0 ;local v42;while true do if (v41==0) then v42="nameplate"   .. v40 ;if (UnitExists(v42) and  not UnitIsFriend("player",v42) and WeakAuras.CheckRange(v42,v32,"<=")) then v31=v31 + (443 -(416 + 26)) ;end break;end end end WeakAuras.ScanEvents("K_NEARBY_ENEMIES",v31);if aura_env.config['NeedTarget'] then if ((UnitExists("target")==false) or (UnitCanAttack("player","target")==false)) then WeakAuras.ScanEvents("K_TRIGED_EXTRA",{});v20("Clear",nil);v21("Clear",nil);return;end end v27={};v27.StPlanning=v31<=1 ;v27.AddsRemain=v31>=(6 -4) ;v27.ExecutePhase=(IsPlayerSpell(v25.MassacreTalent) and (((UnitHealth("target")/UnitHealthMax("target")) * 100)<(16 + 19))) or (((UnitHealth("target")/UnitHealthMax("target")) * 100)<2) ;local v36={};if (v3(v25.Recklessness) and (( not IsPlayerSpell(v25.AngerManagementTalent) and IsPlayerSpell(v25.TitansTormentTalent)) or IsPlayerSpell(v25.AngerManagementTalent) or  not IsPlayerSpell(v25.TitansTormentTalent))) then v36.Recklessness=true;end if v3(v25.Avatar) then v36.Avatar=true;end if ((aura_env.config['SavingCD']==false) and (v18(106 -46 ,478 -(145 + 293) )<=aura_env.config['SavingCDTime'])) then WeakAuras.ScanEvents("K_TRIGED_EXTRA",v36,"Saving");elseif ((aura_env.config['SavingCD']==true) and (v18(60,470 -(44 + 386) )<=aura_env.config['SavingCDTime'])) then WeakAuras.ScanEvents("K_TRIGED_EXTRA",{});else WeakAuras.ScanEvents("K_TRIGED_EXTRA",v36,nil);end local v37=(v9(v25.MeatCleaverBuff)==(1486 -(998 + 488))) or ((v9(v25.MeatCleaverBuff)==(1 + 0)) and ((aura_env.ListenSpellInMeatCleaver==v25.Execute) or (aura_env.ListenSpellInMeatCleaver==v25.Onslaught) or (aura_env.ListenSpellInMeatCleaver==v25.Rampage) or (aura_env.ListenSpellInMeatCleaver==v25.RagingBlow) or (aura_env.ListenSpellInMeatCleaver==v25.Bloodthirst))) ;local v38=function() if (v3(v25.Execute) and ((v7(v25.ExecuteMassacre)==(0 + 0)) or  not IsPlayerSpell(v25.ExecuteMassacreTalent)) and v11(v25.AshenJuggernautBuff) and (v5("player",v25.AshenJuggernautBuff)<v24())) then local v46=0;while true do if (v46==(772 -(201 + 571))) then v20("Execute");return true;end end end if (v3(v25.Execute) and ((v7(v25.ExecuteMassacre)==(1138 -(116 + 1022))) or  not IsPlayerSpell(v25.ExecuteMassacreTalent)) and v11(v25.SuddenDeathBuff) and (v5("player",v25.SuddenDeathBuff)<2) and  not v27.ExecutePhase) then local v47=0 -0 ;while true do if (v47==(0 + 0)) then v20("Execute");return true;end end end if (v3(v25.Bladestorm) and v11(v25.EnrageBuff) and ((IsPlayerSpell(v25.RecklessAbandonTalent) and (v7(v25.Avatar)>=24)) or (IsPlayerSpell(v25.AngerManagementTalent) and (v7(v25.Recklessness)>=(54 -39)) and (v11(v25.Avatar) or (v7(v25.Avatar)>=(28 -20)))))) then if ((aura_env.config[tostring(v25.Bladestorm)]==true) and aura_env.FlagKTrigCD) then v21("Bladestorm");elseif (aura_env.config[tostring(v25.Bladestorm)]~=true) then v20("Bladestorm");return true;end end if (v3(v25.ThunderousRoar) and (v31>(860 -(814 + 45))) and v11(v25.EnrageBuff)) then if ((aura_env.config[tostring(v25.ThunderousRoar)]==true) and aura_env.FlagKTrigCD) then v21("Thunderous Roar");elseif (aura_env.config[tostring(v25.ThunderousRoar)]~=true) then v20("Thunderous Roar");return true;end end if (v3(v25.ChampionsSpear) and v3(v25.Bladestorm) and (v3(v25.Avatar) or v3(v25.Recklessness) or v11(v25.Avatar) or v11(v25.RecklessnessBuff)) and v11(v25.EnrageBuff)) then if ((aura_env.config[tostring(v25.ChampionsSpear)]==true) and aura_env.FlagKTrigCD) then v21("Champions Spear");elseif (aura_env.config[tostring(v25.ChampionsSpear)]~=true) then v20("Champions Spear");return true;end end if (v3(v25.OdynsFury) and (v31>(2 -1)) and IsPlayerSpell(v25.TitanicRageTalent) and v37) then if ((aura_env.config[tostring(v25.OdynsFury)]==true) and aura_env.FlagKTrigCD) then v21("Odyns Fury");elseif (aura_env.config[tostring(v25.OdynsFury)]~=true) then local v71=0 + 0 ;while true do if ((0 + 0)==v71) then v20("Odyns Fury");return true;end end end end if (v3(v25.Bladestorm) and v11(v25.EnrageBuff) and ((IsPlayerSpell(v25.RecklessAbandonTalent) and (v7(v25.Avatar)>=(909 -(261 + 624)))) or (IsPlayerSpell(v25.AngerManagementTalent) and (v7(v25.Recklessness)>=(26 -11)) and (v11(v25.Avatar) or (v7(v25.Avatar)>=8))))) then if ((aura_env.config[tostring(v25.Bladestorm)]==true) and aura_env.FlagKTrigCD) then v21("Bladestorm");elseif (aura_env.config[tostring(v25.Bladestorm)]~=true) then v20("Bladestorm");return true;end end if (v3(v25.Whirlwind) and (v31>=(1082 -(1020 + 60))) and IsPlayerSpell(v25.MeatCleaverTalent) and v37) then local v48=1423 -(630 + 793) ;while true do if (v48==0) then v20("Whirlwind");return true;end end end if (v3(v25.Onslaught) and IsPlayerSpell(v25.TenderizeTalent) and v11(v25.BrutalFinishBuff)) then v20("Onslaught");return true;end if (v3(v25.Rampage) and (v5("player",v25.EnrageBuff)<v24())) then local v49=0;while true do if (v49==(0 -0)) then v20("Rampage");return true;end end end if (v3(v25.Execute) and ((v7(v25.ExecuteMassacre)==0) or  not IsPlayerSpell(v25.ExecuteMassacreTalent)) and (v9(v25.SuddenDeathBuff)>=(9 -7)) and v11(v25.EnrageBuff) and  not v11(v25.BrutalFinishBuff)) then v20("Execute");return true;end if (v3(v25.Execute) and ((v7(v25.ExecuteMassacre)==(0 + 0)) or  not IsPlayerSpell(v25.ExecuteMassacreTalent)) and (v10(v25.MarkedForExecutionDebuff)>=aura_env.config['MarkedForExecutionDebuffStacks']) and v11(v25.EnrageBuff)) then v20("Execute");return true;end if (v3(v25.OdynsFury) and (v31>1) and  not IsPlayerSpell(v25.TitanicRageTalent)) then if ((aura_env.config[tostring(v25.OdynsFury)]==true) and aura_env.FlagKTrigCD) then v21("Odyns Fury");elseif (aura_env.config[tostring(v25.OdynsFury)]~=true) then v20("Odyns Fury");return true;end end if (v3(v25.RagingBlow) and (FindSpellOverrideByID(v25.RagingBlow)==v25.CrushingBlow) and ((C_Spell.GetSpellCharges(v25.RagingBlow).currentCharges==(6 -4)) or (v11(v25.BrutalFinishBuff) and ( not v12(v25.ChampionsMightDebuff) or (v12(v25.ChampionsMightDebuff) and (v6("target",v25.ChampionsMightDebuff)>WeakAuras.gcdDuration())))))) then local v50=1747 -(760 + 987) ;while true do if (v50==(1913 -(1789 + 124))) then v20("Crushing Blow");return true;end end end if (v3(v25.Bloodthirst) and (FindSpellOverrideByID(v25.Bloodthirst)==v25.Bloodbath) and ((v9(v25.BloodcrazeBuff)>=(767 -(745 + 21))) or (IsPlayerSpell(v25.UproarTalent) and (v6("target",v25.BloodbathDotDebuff)<(14 + 26)) and IsPlayerSpell(v25.BloodborneTalent)) or (v11(v25.EnrageBuff) and (v5("player",v25.EnrageBuff)<v24())))) then v20("Bloodbath");return true;end if (v11(446035) and IsPlayerSpell(1227467 -781382 ) and true and (v9(v25.SlaughteringStrikesBuff)<(19 -14)) and ( not v12(v25.ChampionsMightDebuff) or (v12(v25.ChampionsMightDebuff) and (v6("target",v25.ChampionsMightDebuff)>WeakAuras.gcdDuration())))) then local v51=0 + 0 ;while true do if (v51==(0 + 0)) then v20("Raging Blow");return true;end end end if (v3(v25.RagingBlow) and (((v31>=(1063 -(87 + 968))) and (v28>=4)) or (v11(v25.BrutalFinishBuff) and (v9(v25.SlaughteringStrikesBuff)<(22 -17)) and ( not v12(v25.ChampionsMightDebuff) or (v12(v25.ChampionsMightDebuff) and (v6("target",v25.ChampionsMightDebuff)>WeakAuras.gcdDuration())))))) then local v52=0;while true do if (v52==0) then v20("Raging Blow");return true;end end end if (v3(v25.Rampage) and (v29>(105 + 10))) then v20("Rampage");return true;end if (v3(v25.Execute) and ((v7(v25.ExecuteMassacre)==(0 -0)) or  not IsPlayerSpell(v25.ExecuteMassacreTalent)) and v27.ExecutePhase and v12(v25.MarkedForExecutionDebuff) and v11(v25.EnrageBuff) and (v31==(1414 -(447 + 966)))) then v20("Execute");return true;end if (v3(v25.Bloodthirst) and (((((UnitHealth("target")/UnitHealthMax("target")) * (273 -173))<35) and IsPlayerSpell(v25.ViciousContemptTalent) and v11(v25.BrutalFinishBuff) and v11(v25.EnrageBuff) and (v9(v25.BloodcrazeBuff)>=5) and (v31==(1818 -(1703 + 114)))) or ( not (v28>=(705 -(376 + 325))) and (v31>4)))) then v20("Bloodthirst");return true;end if (v3(v25.RagingBlow) and (FindSpellOverrideByID(v25.RagingBlow)==v25.CrushingBlow)) then local v53=0;while true do if (v53==(0 -0)) then v20("Crushing Blow");return true;end end end if (v3(v25.Bloodthirst) and (FindSpellOverrideByID(v25.Bloodthirst)==v25.Bloodbath)) then local v54=0 -0 ;while true do if ((0 + 0)==v54) then v20("Bloodbath");return true;end end end if (v3(v25.RagingBlow) and (v11(v25.OpportunistBuff))) then v20("Raging Blow");return true;end if (v3(v25.Bloodthirst) and (((UnitHealth("target")/UnitHealthMax("target")) * (220 -120))<(49 -(9 + 5))) and IsPlayerSpell(v25.ViciousContemptTalent) and (v9(v25.BloodcrazeBuff)>=(380 -(85 + 291)))) then local v55=1265 -(243 + 1022) ;while true do if (v55==0) then v20("Bloodthirst");return true;end end end if (v3(v25.RagingBlow) and (v14(v25.RagingBlow)==(7 -5))) then local v56=0;while true do if ((0 + 0)==v56) then v20("Raging Blow");return true;end end end if (v3(v25.Onslaught) and (IsPlayerSpell(v25.TenderizeTalent))) then v20("Onslaught");return true;end if v3(v25.RagingBlow) then v20("Raging Blow");return true;end if v3(v25.Rampage) then local v57=0;while true do if ((1180 -(1123 + 57))==v57) then v20("Rampage");return true;end end end if (v3(v25.OdynsFury) and (v11(v25.EnrageBuff) or IsPlayerSpell(v25.TitanicRageTalent))) then if ((aura_env.config[tostring(v25.OdynsFury)]==true) and aura_env.FlagKTrigCD) then v21("Odyns Fury");elseif (aura_env.config[tostring(v25.OdynsFury)]~=true) then local v72=0 + 0 ;while true do if (v72==0) then v20("Odyns Fury");return true;end end end end if (v3(v25.Execute) and ((v7(v25.ExecuteMassacre)==(254 -(163 + 91))) or  not IsPlayerSpell(v25.ExecuteMassacreTalent)) and (v11(v25.SuddenDeathBuff))) then local v58=1930 -(1869 + 61) ;while true do if (v58==(0 + 0)) then v20("Execute");return true;end end end if v3(v25.Bloodthirst) then local v59=0 -0 ;while true do if (v59==(0 -0)) then v20("Bloodthirst");return true;end end end if v3(v25.ThunderousRoar) then if ((aura_env.config[tostring(v25.ThunderousRoar)]==true) and aura_env.FlagKTrigCD) then v21("Thunderous Roar");elseif (aura_env.config[tostring(v25.ThunderousRoar)]~=true) then local v73=0;while true do if (v73==0) then v20("Thunderous Roar");return true;end end end end if v3(v25.WreckingThrow) then local v60=0 + 0 ;while true do if (v60==0) then v20("Wrecking Throw");return true;end end end if v3(v25.Whirlwind) then v20("Whirlwind");return true;end end;local v39=function() if v3(v25.Ravager) then if ((aura_env.config[tostring(v25.Ravager)]==true) and aura_env.FlagKTrigCD) then v21("Ravager");elseif (aura_env.config[tostring(v25.Ravager)]~=true) then local v74=0;while true do if (v74==(0 -0)) then v20("Ravager");return true;end end end end if (v3(v25.ThunderousRoar) and (v31>(1 + 0)) and v11(v25.EnrageBuff)) then if ((aura_env.config[tostring(v25.ThunderousRoar)]==true) and aura_env.FlagKTrigCD) then v21("Thunderous Roar");elseif (aura_env.config[tostring(v25.ThunderousRoar)]~=true) then v20("Thunderous Roar");return true;end end if (v3(v25.ChampionsSpear) and v11(v25.EnrageBuff) and IsPlayerSpell(v25.ChampionsMightTalent)) then if ((aura_env.config[tostring(v25.ChampionsSpear)]==true) and aura_env.FlagKTrigCD) then v21("Champions Spear");elseif (aura_env.config[tostring(v25.ChampionsSpear)]~=true) then local v75=1474 -(1329 + 145) ;while true do if (v75==(971 -(140 + 831))) then v20("Champions Spear");return true;end end end end if (v3(v25.ThunderClap) and v37 and IsPlayerSpell(v25.MeatCleaverTalent) and (v31>=2)) then local v61=1850 -(1409 + 441) ;while true do if (v61==(718 -(15 + 703))) then v20("Thunder Clap");return true;end end end if ((v7(v25.ThunderClap)==(0 + 0)) and aura_env.config[tostring(v25.ThunderClap)] and (FindSpellOverrideByID(v25.ThunderClap)==v25.ThunderBlast) and v11(v25.EnrageBuff) and IsPlayerSpell(v25.MeatCleaverTalent)) then v20("Thunder Blast");return true;end if (v3(v25.Rampage) and ( not v11(v25.EnrageBuff) or (IsPlayerSpell(v25.Bladestorm) and (v7(v25.Bladestorm)<=v24()) and  not v12(v25.ChampionsMightDebuff)))) then v20("Rampage");return true;end if (v3(v25.Execute) and ((v7(v25.ExecuteMassacre)==0) or  not IsPlayerSpell(v25.ExecuteMassacreTalent)) and IsPlayerSpell(v25.AshenJuggernautTalent) and (v5("player",v25.AshenJuggernautBuff)<=v24())) then v20("Execute");return true;end if (v3(v25.Bladestorm) and v11(v25.EnrageBuff) and IsPlayerSpell(v25.UnhingedTalent)) then if ((aura_env.config[tostring(v25.Bladestorm)]==true) and aura_env.FlagKTrigCD) then v21("Bladestorm");elseif (aura_env.config[tostring(v25.Bladestorm)]~=true) then v20("Bladestorm");return true;end end if (v3(v25.Bloodthirst) and (FindSpellOverrideByID(v25.Bloodthirst)==v25.Bloodbath)) then v20("Bloodbath");return true;end if (v3(v25.Rampage) and (v29>=(553 -(262 + 176))) and IsPlayerSpell(v25.RecklessAbandonTalent) and v11(v25.RecklessnessBuff) and (v9(v25.SlaughteringStrikesBuff)>=(1724 -(345 + 1376)))) then v20("Rampage");return true;end if (v3(v25.RagingBlow) and (FindSpellOverrideByID(v25.RagingBlow)==v25.CrushingBlow)) then local v62=688 -(198 + 490) ;while true do if (v62==(0 -0)) then v20("Crushing Blow");return true;end end end if (v3(v25.Onslaught) and (IsPlayerSpell(v25.TenderizeTalent))) then local v63=0;while true do if (v63==(0 -0)) then v20("Onslaught");return true;end end end if (v3(v25.Bloodthirst) and IsPlayerSpell(v25.ViciousContemptTalent) and (((UnitHealth("target")/UnitHealthMax("target")) * (1306 -(696 + 510)))<(73 -38))) then v20("Bloodthirst");return true;end if (v3(v25.Rampage) and (v29>=100)) then local v64=1262 -(1091 + 171) ;while true do if (v64==(0 + 0)) then v20("Rampage");return true;end end end if v3(v25.Bloodthirst) then local v65=0 -0 ;while true do if (v65==0) then v20("Bloodthirst");return true;end end end if (v3(v25.OdynsFury) and (v31>(3 -2)) and (v11(v25.EnrageBuff) or IsPlayerSpell(v25.TitanicRageTalent))) then if ((aura_env.config[tostring(v25.OdynsFury)]==true) and aura_env.FlagKTrigCD) then v21("Odyns Fury");elseif (aura_env.config[tostring(v25.OdynsFury)]~=true) then v20("Odyns Fury");return true;end end if v3(v25.RagingBlow) then local v66=374 -(123 + 251) ;while true do if (v66==(0 -0)) then v20("Raging Blow");return true;end end end if v3(v25.Rampage) then local v67=0;while true do if (v67==0) then v20("Rampage");return true;end end end if ((v7(v25.ThunderClap)==0) and aura_env.config[tostring(v25.ThunderClap)] and (FindSpellOverrideByID(v25.ThunderClap)==v25.ThunderBlast) and  not IsPlayerSpell(v25.MeatCleaverTalent)) then local v68=698 -(208 + 490) ;while true do if ((0 + 0)==v68) then v20("Thunder Blast");return true;end end end if v3(v25.ThunderousRoar) then if ((aura_env.config[tostring(v25.ThunderousRoar)]==true) and aura_env.FlagKTrigCD) then v21("Thunderous Roar");elseif (aura_env.config[tostring(v25.ThunderousRoar)]~=true) then v20("Thunderous Roar");return true;end end if (v3(v25.OdynsFury) and (v11(v25.EnrageBuff) or IsPlayerSpell(v25.TitanicRageTalent))) then if ((aura_env.config[tostring(v25.OdynsFury)]==true) and aura_env.FlagKTrigCD) then v21("Odyns Fury");elseif (aura_env.config[tostring(v25.OdynsFury)]~=true) then v20("Odyns Fury");return true;end end if (v3(v25.ChampionsSpear) and  not IsPlayerSpell(v25.ChampionsMightTalent)) then if ((aura_env.config[tostring(v25.ChampionsSpear)]==true) and aura_env.FlagKTrigCD) then v21("Champions Spear");elseif (aura_env.config[tostring(v25.ChampionsSpear)]~=true) then local v76=0;while true do if ((0 + 0)==v76) then v20("Champions Spear");return true;end end end end if (v3(v25.Execute) and ((v7(v25.ExecuteMassacre)==(836 -(660 + 176))) or  not IsPlayerSpell(v25.ExecuteMassacreTalent))) then v20("Execute");return true;end if v3(v25.WreckingThrow) then local v69=0;while true do if (v69==(0 + 0)) then v20("Wrecking Throw");return true;end end end if v3(v25.ThunderClap) then v20("Thunder Clap");return true;end if v3(v25.Whirlwind) then local v70=202 -(14 + 188) ;while true do if (v70==0) then v20("Whirlwind");return true;end end end end;if IsPlayerSpell(v25.SlayersDominanceTalent) then local v45=0;while true do if (v45==(675 -(534 + 141))) then v38();return true;end end end if IsPlayerSpell(v25.LightningStrikesTalent) then v39();return true;end v20("Clear");v21("Clear");end;