function() if (aura_env.LastUpdate and (aura_env.LastUpdate>(GetTime() -aura_env.config['UpdateFrequency']))) then return;end aura_env.LastUpdate=GetTime();local v2=GetTime();local v3=aura_env.OffCooldown;local v4=aura_env.OffCooldownNotCasting;local v5=aura_env.GetRemainingAuraDuration;local v6=aura_env.GetRemainingDebuffDuration;local v7=aura_env.GetRemainingSpellCooldown;local v8=aura_env.IsCasting;local v9=aura_env.GetPlayerStacks;local v10=aura_env.GetTargetStacks;local v11=aura_env.PlayerHasBuff;local v12=aura_env.TargetHasDebuff;local v13=aura_env.HasBloodlust;local v14=aura_env.GetSpellChargesFractional;local v15=aura_env.GetTimeToNextCharge;local v16=aura_env.GetTimeToFullCharges;local v17=aura_env.TargetTimeToXPct;local v18=aura_env.FightRemains;local v19=aura_env.IsAuraRefreshable;local v20=aura_env.KTrig;local v21=aura_env.KTrigCD;aura_env.FlagKTrigCD=true;local v23=aura_env.FullGCD;local v24=aura_env.TalentRank;local v25=1 -0 ;local v26=50;local v27=50 + 0 ;local v28=aura_env.ids;aura_env.OutOfRange=false;local v30={};local v31=WeakAuras.GetNumSetItemsEquipped(2719 -(368 + 423) );local v32=WeakAuras.GetNumSetItemsEquipped(5895 -4019 );local v33=UnitPower("player",Enum.PowerType.ComboPoints);local v34=UnitPowerMax("player",Enum.PowerType.ComboPoints);local v35=v11(v28.SubterfugeBuff) or v11(v28.Stealth) or v11(v28.VanishBuff) ;local v36=v33;local v37=UnitPower("player",Enum.PowerType.Energy);local v38=UnitPowerMax("player",Enum.PowerType.Energy);local v39=aura_env.DisorientingStrikesCount>(18 -(10 + 8)) ;local v40=0;local v41=8;local v42=0 -0 ;local v43=454 -(416 + 26) ;for v62=3 -2 ,18 + 22  do local v63=0 -0 ;local v64;while true do if (v63==(439 -(145 + 293))) then if (UnitExists(v64) and (UnitIsFriend("player",v64)==false) and WeakAuras.CheckRange(v64,v43,"<=")) then v42=v42 + (431 -(44 + 386)) ;end break;end if (v63==(1486 -(998 + 488))) then v64="nameplate"   .. v62 ;if (UnitExists(v64) and (UnitIsFriend("player",v64)==false) and WeakAuras.CheckRange(v64,v41,"<=")) then v40=v40 + 1 ;end v63=1 + 0 ;end end end WeakAuras.ScanEvents("K_NEARBY_ENEMIES",v40);WeakAuras.ScanEvents("K_FURTHER_ENEMIES",v42);local v44=0 + 0 ;local v45=0;local v46=772 -(201 + 571) ;local v47=1138 -(116 + 1022) ;local v48=0 -0 ;local v49=0;local v50=max(aura_env.RTBContainerExpires-GetTime() ,0);local v51={193356,705886 -512529 ,194217 -(814 + 45) ,10420 + 182939 ,200485 -(261 + 624) ,199603};for v65,v66 in ipairs(v51) do if v11(v66) then v44=v44 + (1 -0) ;v45=math.max(v45,v5("player",v66));v46=((v46==(1080 -(1020 + 60))) and v5("player",v66)) or math.min(v46,v5("player",v66)) ;if (v5("player",v66)>(v50 + (1423.3 -(630 + 793)))) then v48=v48 + (3 -2) ;else if (v5("player",v66)>(v50-(0.3 -0))) then v49=v49 + 1 ;end v47=v47 + 1 ;end end end v30.AmbushCondition=(IsPlayerSpell(v28.HiddenOpportunityTalent) or ((v34-v33)>=(1 + 1 + ((IsPlayerSpell(v28.ImprovedAmbushTalent) and (3 -2)) or 0) + ((v11(v28.BroadsideBuff) and (1748 -(760 + 987))) or (1913 -(1789 + 124)))))) and (v37>=(816 -(745 + 21))) ;v30.FinishCondition=v33>=((v34-(1 + 0)) -((((v35 and IsPlayerSpell(v28.CrackshotTalent)) or ((IsPlayerSpell(v28.HandOfFateTalent) or IsPlayerSpell(v28.FlawlessFormTalent)) and IsPlayerSpell(v28.HiddenOpportunityTalent) and (v11(v28.AudacityBuff) or v11(v28.OpportunityBuff)))) and 1) or (0 -0))) ;v30.BuffsAbovePandemic=(((v5("player",v28.BroadsideBuff)>(152 -113)) and (1 + 0)) or (0 + 0)) + (((v5("player",v28.RuthlessPrecisionBuff)>(1094 -(87 + 968))) and (4 -3)) or (0 + 0)) + (((v5("player",v28.TrueBearingBuff)>39) and (2 -1)) or (1413 -(447 + 966))) + (((v5("player",v28.GrandMeleeBuff)>39) and (2 -1)) or (1817 -(1703 + 114))) + (((v5("player",v28.BuriedTreasureBuff)>(740 -(376 + 325))) and 1) or (0 -0)) + (((v5("player",v28.SkullAndCrossbonesBuff)>(119 -80)) and (1 + 0)) or (0 -0)) ;local v55={};if aura_env.config['NeedTarget'] then if ((UnitExists("target")==false) or (UnitCanAttack("player","target")==false)) then WeakAuras.ScanEvents("K_TRIGED_EXTRA",v55);v20("Clear",nil);v21("Clear",nil);return;end end if (v3(v28.AdrenalineRush) and (( not v11(v28.AdrenalineRush) and ( not v30.FinishCondition or  not IsPlayerSpell(v28.ImprovedAdrenalineRushTalent))) or (v11(v28.AdrenalineRushBuff) and (v33<=2)))) then v55.AdrenalineRush=true;end if (v3(v28.GhostlyStrike) and ((v33<v34) or (v24(v28.FanTheHammerTalentNode)>1))) then v55.GhostlyStrike=true;end if (v3(v28.ThistleTea) and  not v11(v28.ThistleTea) and ((v37<v27) or (v17(14 -(9 + 5) ,1375 -(85 + 291) )<(C_Spell.GetSpellCharges(v28.ThistleTea).currentCharges * (1271 -(243 + 1022)))))) then v55.ThistleTea=true;end if (v3(v28.KeepItRolling) and (((v44>=(14 -10)) and (v49<=(2 + 0))) or ((v49>=5) and (v44==(1186 -(1123 + 57)))))) then v55.KeepItRolling=true;end if (v3(v28.KeepItRolling) and (v44>=4) and (v49<=(2 + 0))) then v55.KeepItRolling=true;end if (v3(v28.KeepItRolling) and (v44>=3) and (v49<=2) and v11(v28.BroadsideBuff) and v11(v28.RuthlessPrecisionBuff) and v11(v28.TrueBearingBuff)) then v55.KeepItRolling=true;end if v3(v28.ColdBlood) then v55.ColdBlood=true;end WeakAuras.ScanEvents("K_TRIGED_EXTRA",v55,nil);local v56=function() if (v3(v28.Ambush) and IsPlayerSpell(v28.HiddenOpportunityTalent) and v11(v28.AudacityBuff)) then v20("Ambush");return true;end if (v3(v28.SinisterStrike) and v39 and  not v35 and  not IsPlayerSpell(v28.HiddenOpportunityTalent) and (v9(v28.EscalatingBladeBuff)<4) and  not aura_env.HasTww34PcTricksterBuff) then local v78=254 -(163 + 91) ;while true do if ((1930 -(1869 + 61))==v78) then v20("Sinister Strike");return true;end end end if (v3(v28.PistolShot) and IsPlayerSpell(v28.FanTheHammerTalent) and IsPlayerSpell(v28.AudacityBuff) and IsPlayerSpell(v28.HiddenOpportunityTalent) and v11(v28.OpportunityBuff) and  not v11(v28.AudacityBuff)) then local v79=0;while true do if (v79==(0 + 0)) then v20("Pistol Shot");return true;end end end if (v3(v28.BladeFlurry) and IsPlayerSpell(v28.DeftManeuversTalent) and (v40>=(14 -10)) and ((v33<=(2 -0)) or  not v11(v28.AdrenalineRushBuff) or  not IsPlayerSpell(v28.UnseenBladeTalent))) then v20("Blade Flurry");return true;end if (v3(v28.BladeFlurry) and IsPlayerSpell(v28.DeftManeuversTalent) and ((v34-v33)==(v40 + ((v11(v28.BroadsideBuff) and (1 + 0)) or 0))) and (v40>=((3 -0) -((IsPlayerSpell(v28.HandOfFateTalent) and 1) or (0 + 0)))) and IsPlayerSpell(v28.FanTheHammerTalent)) then local v80=1474 -(1329 + 145) ;while true do if (v80==(971 -(140 + 831))) then v20("Blade Flurry");return true;end end end if (v3(v28.PistolShot) and (v24(v28.FanTheHammerTalentNode)>(1851 -(1409 + 441))) and v11(v28.OpportunityBuff) and ((v9(v28.OpportunityBuff)>=((IsPlayerSpell(v28.FanTheHammerTalent) and (724 -(15 + 703))) or (1 + 0))) or (v5("player",v28.OpportunityBuff)<(440 -(262 + 176))))) then local v81=1721 -(345 + 1376) ;while true do if (v81==(688 -(198 + 490))) then v20("Pistol Shot");return true;end end end if (v3(v28.PistolShot) and IsPlayerSpell(v28.FanTheHammerTalent) and v11(v28.OpportunityBuff) and (((v34-v33)>=((4 -3) + ((((IsPlayerSpell(v28.QuickDrawTalent) and 1) or 0) + ((v11(v28.BroadsideBuff) and (2 -1)) or (1206 -(696 + 510)))) * (v24(v28.FanTheHammerTalentNode) + (1 -0))))) or (v33<=((IsPlayerSpell(v28.RuthlessnessTalent) and 1) or 0)))) then local v82=1262 -(1091 + 171) ;while true do if (v82==0) then v20("Pistol Shot");return true;end end end if (v3(v28.PistolShot) and  not IsPlayerSpell(v28.FanTheHammerTalent) and v11(v28.OpportunityBuff) and (((v38-v37)>(13 + 62)) or ((v34-v33)<=(1 + ((v11(v28.BroadsideBuff) and (3 -2)) or 0))) or IsPlayerSpell(v28.QuickDrawTalent) or (IsPlayerSpell(v28.AudacityBuff) and  not v11(v28.AudacityBuff)))) then v20("Pistol Shot");return true;end if ((FindSpellOverrideByID(v28.Dispatch)==v28.CoupDeGrace) and  not v35) then local v83=0 -0 ;while true do if (v83==(374 -(123 + 251))) then v20("Dispatch");return true;end end end if (v3(v28.Ambush) and (IsPlayerSpell(v28.HiddenOpportunityTalent))) then local v84=0 -0 ;while true do if (v84==(698 -(208 + 490))) then v20("Ambush");return true;end end end if v3(v28.SinisterStrike) then v20("Sinister Strike");return true;end end;local v57=function() local v67=0 + 0 ;while true do if (v67==(1 + 0)) then if (v3(v28.BetweenTheEyes) and (v11(v28.RuthlessPrecisionBuff) or (v5("player",v28.BetweenTheEyesBuff)<(840 -(660 + 176))) or  not IsPlayerSpell(v28.MeanStreakTalent)) and ( not v11(v28.GreenskinsWickersBuff) or  not IsPlayerSpell(v28.GreenskinsWickersTalent))) then local v87=0 + 0 ;while true do if (v87==0) then v20("Between the Eyes");return true;end end end if v3(v28.Dispatch) then v20("Dispatch");return true;end break;end if (0==v67) then if v3(v28.KillingSpree) then if ((aura_env.config[tostring(v28.KillingSpree)]==true) and aura_env.FlagKTrigCD) then v21("Killing Spree");elseif (aura_env.config[tostring(v28.KillingSpree)]~=true) then v20("Killing Spree");return true;end end if (FindSpellOverrideByID(v28.Dispatch)==v28.CoupDeGrace) then local v88=202 -(14 + 188) ;while true do if (v88==(675 -(534 + 141))) then v20("Dispatch");return true;end end end v67=1 + 0 ;end end end;local v58=function() local v68=0 + 0 ;while true do if (v68==0) then if (v3(v28.Vanish) and ( not IsPlayerSpell(v28.UnseenBladeTalent) or  not IsPlayerSpell(v28.KillingSpreeTalent)) and  not v3(v28.BetweenTheEyes) and (v5("player",v28.RuthlessPrecisionBuff)>(4 + 0))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v96=0 -0 ;while true do if (v96==(0 -0)) then v20("Vanish");return true;end end end end if (v3(v28.Vanish) and ( not IsPlayerSpell(v28.UnseenBladeTalent) or  not IsPlayerSpell(v28.KillingSpreeTalent)) and (GetUnitChargedPowerPoints("player")~=nil)) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v97=0;while true do if (v97==(0 -0)) then v20("Vanish");return true;end end end end v68=1 + 0 ;end if (v68==(1 + 0)) then if (v3(v28.Vanish) and ((IsPlayerSpell(v28.UnseenBladeTalent) and IsPlayerSpell(v28.KillingSpreeTalent) and (v7(v28.KillingSpree)>(426 -(115 + 281))) and ((v2-aura_env.LastKillingSpree)<=(23 -13))) or  not (v31>=4))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and ((v16(v28.Vanish)<15) or (v18(50 + 10 ,v41)<8))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end break;end end end;local v59=function() local v69=0;while true do if (v69==(0 -0)) then if (v3(v28.RollTheBones) and (v44==(0 -0))) then v20("Roll the Bones");return true;end if (v3(v28.RollTheBones) and (v32>=(871 -(550 + 317))) and (v47<=1) and ((v30.BuffsAbovePandemic<5) or (v45<(60 -18)))) then v20("Roll the Bones");return true;end v69=1 -0 ;end if (v69==(5 -3)) then if (v3(v28.RollTheBones) and (v32<(289 -(134 + 151))) and IsPlayerSpell(v28.SuperchargerTalent) and v11(v28.LoadedDiceBuff) and (v44<=(1667 -(970 + 695)))) then local v89=0;while true do if (v89==(0 -0)) then v20("Roll the Bones");return true;end end end if (v3(v28.RollTheBones) and  not (v32>=(1994 -(582 + 1408))) and  not IsPlayerSpell(v28.KeepItRollingTalent) and  not IsPlayerSpell(v28.SuperchargerTalent) and v11(v28.LoadedDiceBuff) and (v44<=(6 -4)) and  not v11(v28.BroadsideBuff) and  not v11(v28.RuthlessPrecisionBuff) and  not v11(v28.TrueBearingBuff)) then v20("Roll the Bones");return true;end break;end if (v69==1) then if (v3(v28.RollTheBones) and (v32>=(4 -0)) and ((v44<=2) or (((v45<11) or  not IsPlayerSpell(v28.KeepItRolling)) and (v47<(18 -13)) and IsPlayerSpell(v28.SuperchargerTalent) and (v49>(1824 -(1195 + 629)))))) then local v90=0 -0 ;while true do if (v90==(241 -(187 + 54))) then v20("Roll the Bones");return true;end end end if (v3(v28.RollTheBones) and (v32<(784 -(162 + 618))) and (v47<=((v11(v28.LoadedDiceBuff) and (1 + 0)) or (0 + 0)))) then local v91=0;while true do if (v91==(0 -0)) then v20("Roll the Bones");return true;end end end v69=2;end end end;local v60=function() if (v3(v28.BladeFlurry) and (v40>=2) and (v5("player",v28.BladeFlurry)<v25)) then local v85=0 -0 ;while true do if (v85==0) then v20("Blade Flurry");return true;end end end if v59() then return true;end if (v3(v28.Vanish) and IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.SubterfugeTalent) and v11(v28.AdrenalineRushBuff) and  not v35 and (v5("player",v28.AdrenalineRushBuff)<2) and (v7(v28.AdrenalineRush)>(3 + 27))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if ( not v35 and ((v3(v28.KillingSpree) and IsPlayerSpell(v28.KillingSpreeTalent)) or (v9(v28.EscalatingBladeBuff)>=(1640 -(1373 + 263))) or aura_env.HasTww34PcTricksterBuff) and v30.FinishCondition) then v57();return true;end if ( not v35 and IsPlayerSpell(v28.CrackshotTalent) and IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.SubterfugeTalent) and v11(v28.AdrenalineRushBuff) and v30.FinishCondition) then if v58() then return true;end end if (v3(v28.Vanish) and  not v35 and (v30.FinishCondition or  not IsPlayerSpell(v28.CrackshotTalent)) and ( not IsPlayerSpell(v28.UnderhandedUpperHandTalent) or  not IsPlayerSpell(v28.SubterfugeTalent) or  not IsPlayerSpell(v28.CrackshotTalent)) and ((v11(v28.AdrenalineRushBuff) and IsPlayerSpell(v28.SubterfugeTalent) and IsPlayerSpell(v28.UnderhandedUpperHandTalent)) or (( not IsPlayerSpell(v28.SubterfugeTalent) or  not IsPlayerSpell(v28.UnderhandedUpperHandTalent)) and IsPlayerSpell(v28.HiddenOpportunityTalent) and  not v11(v28.AudacityBuff) and (v9(v28.OpportunityBuff)<((IsPlayerSpell(v28.FanTheHammerTalent) and (1006 -(451 + 549))) or (1 + 0))) and v30.AmbushCondition) or ( not IsPlayerSpell(v28.HiddenOpportunityTalent) and (IsPlayerSpell(v28.TakeEmBySurpriseTalent) or IsPlayerSpell(v28.DoubleJeopardyTalent))))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v95=0;while true do if (v95==(0 -0)) then v20("Vanish");return true;end end end end if (v3(v28.BladeRush) and (v37<v26) and  not v35) then local v86=0 -0 ;while true do if (v86==(1384 -(746 + 638))) then v20("Blade Rush");return true;end end end end;local v61=function() local v70=0 + 0 ;while true do if (1==v70) then if (v3(v28.PistolShot) and IsPlayerSpell(v28.CrackshotTalent) and (v24(v28.FanTheHammerTalentNode)>(1 -0)) and (v9(v28.OpportunityBuff)>=(347 -(218 + 123))) and ((v11(v28.BroadsideBuff) and (v33<=(1582 -(1535 + 46)))) or v11(v28.GreenskinsWickersBuff))) then v20("Pistol Shot");return true;end if (v3(v28.Ambush) and (IsPlayerSpell(v28.HiddenOpportunityTalent))) then local v92=0 + 0 ;while true do if (v92==(0 + 0)) then v20("Ambush");return true;end end end break;end if (v70==(560 -(306 + 254))) then if (v3(v28.BetweenTheEyes) and v30.FinishCondition and IsPlayerSpell(v28.CrackshotTalent) and ( not v11(v28.Shadowmeld) or v35)) then local v93=0 + 0 ;while true do if (v93==0) then v20("Between the Eyes");return true;end end end if (v3(v28.Dispatch) and v30.FinishCondition) then local v94=0 -0 ;while true do if (v94==(1467 -(899 + 568))) then v20("Dispatch");return true;end end end v70=1;end end end;if v60() then return true;end if v35 then if v61() then return true;end end if v30.FinishCondition then v57();return true;end if v56() then return true;end v20("Clear");end;