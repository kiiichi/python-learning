function() if (aura_env.LastUpdate and (aura_env.LastUpdate>(GetTime() -aura_env.config['UpdateFrequency']))) then return;end aura_env.LastUpdate=GetTime();local v2=GetTime();local v3=aura_env.OffCooldown;local v4=aura_env.OffCooldownNotCasting;local v5=aura_env.GetRemainingAuraDuration;local v6=aura_env.GetRemainingDebuffDuration;local v7=aura_env.GetRemainingSpellCooldown;local v8=aura_env.IsCasting;local v9=aura_env.GetPlayerStacks;local v10=aura_env.GetTargetStacks;local v11=aura_env.PlayerHasBuff;local v12=aura_env.TargetHasDebuff;local v13=aura_env.HasBloodlust;local v14=aura_env.GetSpellChargesFractional;local v15=aura_env.GetTimeToNextCharge;local v16=aura_env.GetTimeToFullCharges;local v17=aura_env.TargetTimeToXPct;local v18=aura_env.FightRemains;local v19=aura_env.IsAuraRefreshable;local v20=aura_env.KTrig;local v21=aura_env.KTrigCD;aura_env.FlagKTrigCD=true;local v23=aura_env.FullGCD;local v24=aura_env.TalentRank;local v25=1 + 0 ;local v26=68 -(10 + 8) ;local v27=50;local v28=aura_env.ids;aura_env.OutOfRange=false;local v30={};local v31=WeakAuras.GetNumSetItemsEquipped(7216 -5340 );local v32=UnitPower("player",Enum.PowerType.ComboPoints);local v33=UnitPowerMax("player",Enum.PowerType.ComboPoints);local v34=v11(v28.SubterfugeBuff) or v11(v28.Stealth) or v11(v28.VanishBuff) ;local v35=v32;local v36=UnitPower("player",Enum.PowerType.Energy);local v37=UnitPowerMax("player",Enum.PowerType.Energy);local v38=aura_env.DisorientingStrikesCount>(442 -(416 + 26)) ;local v39=0 -0 ;local v40=8;for v59=1,18 + 22  do local v60=0;local v61;while true do if (v60==(0 -0)) then v61="nameplate"   .. v59 ;if (UnitExists(v61) and (UnitIsFriend("player",v61)==false) and WeakAuras.CheckRange(v61,v40,"<=")) then v39=v39 + (439 -(145 + 293)) ;end break;end end end WeakAuras.ScanEvents("K_NEARBY_ENEMIES",v39);local v41=430 -(44 + 386) ;local v42=1486 -(998 + 488) ;local v43=0;local v44=0 + 0 ;local v45=0 + 0 ;local v46=772 -(201 + 571) ;local v47=max(aura_env.RTBContainerExpires-GetTime() ,1138 -(116 + 1022) );local v48={804992 -611636 ,193357,686631 -493273 ,476429 -283070 ,70527 + 129073 ,200488 -(261 + 624) };for v62,v63 in ipairs(v48) do if v11(v63) then local v75=0 -0 ;while true do if (v75==1) then v43=((v43==(1080 -(1020 + 60))) and v5("player",v63)) or math.min(v43,v5("player",v63)) ;if (v5("player",v63)>(v47 + (1423.3 -(630 + 793)))) then v45=v45 + 1 ;else local v98=0;while true do if (v98==0) then if (v5("player",v63)>(v47-(0.3 -0))) then v46=v46 + (4 -3) ;end v44=v44 + 1 + 0 ;break;end end end break;end if (v75==(0 -0)) then v41=v41 + (1748 -(760 + 987)) ;v42=math.max(v42,v5("player",v63));v75=1914 -(1789 + 124) ;end end end end v30.AmbushCondition=(IsPlayerSpell(v28.HiddenOpportunityTalent) or ((v33-v32)>=((768 -(745 + 21)) + ((IsPlayerSpell(v28.ImprovedAmbushTalent) and (1 + 0)) or (0 -0)) + ((v11(v28.BroadsideBuff) and (3 -2)) or 0)))) and (v36>=(1 + 49)) ;v30.FinishCondition=v32>=((v33-(1 + 0)) -((((v34 and IsPlayerSpell(v28.CrackshotTalent)) or ((IsPlayerSpell(v28.HandOfFateTalent) or IsPlayerSpell(v28.FlawlessFormTalent)) and IsPlayerSpell(v28.HiddenOpportunityTalent) and (v11(v28.AudacityBuff) or v11(v28.OpportunityBuff)))) and 1) or 0)) ;v30.BuffsAbovePandemic=(((v5("player",v28.BroadsideBuff)>(1094 -(87 + 968))) and (4 -3)) or 0) + (((v5("player",v28.RuthlessPrecisionBuff)>(36 + 3)) and (2 -1)) or (1413 -(447 + 966))) + (((v5("player",v28.TrueBearingBuff)>(106 -67)) and 1) or (1817 -(1703 + 114))) + (((v5("player",v28.GrandMeleeBuff)>(740 -(376 + 325))) and 1) or (0 -0)) + (((v5("player",v28.BuriedTreasureBuff)>(119 -80)) and (1 + 0)) or (0 -0)) + (((v5("player",v28.SkullAndCrossbonesBuff)>39) and 1) or (14 -(9 + 5))) ;local v52={};if aura_env.config['NeedTarget'] then if ((UnitExists("target")==false) or (UnitCanAttack("player","target")==false)) then local v84=0;while true do if (v84==(376 -(85 + 291))) then WeakAuras.ScanEvents("K_TRIGED_EXTRA",v52);v20("Clear",nil);v84=1266 -(243 + 1022) ;end if (v84==(3 -2)) then v21("Clear",nil);return;end end end end if (v3(v28.AdrenalineRush) and  not v11(v28.AdrenalineRush) and ( not v30.FinishCondition or  not IsPlayerSpell(v28.ImprovedAdrenalineRushTalent))) then v52.AdrenalineRush=true;end if (v3(v28.AdrenalineRush) and v11(v28.AdrenalineRush) and IsPlayerSpell(v28.ImprovedAdrenalineRushTalent) and (v32<=(2 + 0))) then v52.AdrenalineRush=true;end if (v3(v28.GhostlyStrike) and ((v32<v33) or (v24(v28.FanTheHammerTalentNode)>(1181 -(1123 + 57))))) then v52.GhostlyStrike=true;end if (v3(v28.ThistleTea) and  not v11(v28.ThistleTea) and ((v36<aura_env.config['ThistleTeaEnergy']) or (v17(0 + 0 ,1253 -(163 + 91) )<(C_Spell.GetSpellCharges(v28.ThistleTea).currentCharges * (1936 -(1869 + 61)))))) then v52.ThistleTea=true;end if (v3(v28.KeepItRolling) and (v46>=(2 + 3)) and (v41==6)) then v52.KeepItRolling=true;end if (v3(v28.KeepItRolling) and (v41>=4) and (v46<=(6 -4))) then v52.KeepItRolling=true;end if (v3(v28.KeepItRolling) and (v41>=3) and (v46<=(2 -0)) and v11(v28.BroadsideBuff) and v11(v28.RuthlessPrecisionBuff) and v11(v28.TrueBearingBuff)) then v52.KeepItRolling=true;end if v3(v28.ColdBlood) then v52.ColdBlood=true;end WeakAuras.ScanEvents("K_TRIGED_EXTRA",v52,nil);local v53=function() local v64=0;while true do if (v64==(1 + 2)) then if ((FindSpellOverrideByID(v28.Dispatch)==v28.CoupDeGrace) and  not v34) then local v85=0;while true do if (v85==0) then v20("Dispatch");return true;end end end if (v3(v28.Ambush) and (IsPlayerSpell(v28.HiddenOpportunityTalent))) then local v86=0 -0 ;while true do if (v86==0) then v20("Ambush");return true;end end end v64=4 + 0 ;end if (v64==1) then if (v3(v28.PistolShot) and IsPlayerSpell(v28.FanTheHammerTalent) and IsPlayerSpell(v28.AudacityBuff) and IsPlayerSpell(v28.HiddenOpportunityTalent) and v11(v28.OpportunityBuff) and  not v11(v28.AudacityBuff)) then local v87=1474 -(1329 + 145) ;while true do if (v87==0) then v20("Pistol Shot");return true;end end end if (v3(v28.PistolShot) and (v24(v28.FanTheHammerTalentNode)>(972 -(140 + 831))) and v11(v28.OpportunityBuff) and ((v9(v28.OpportunityBuff)>=((IsPlayerSpell(v28.FanTheHammerTalent) and (1856 -(1409 + 441))) or (719 -(15 + 703)))) or (v5("player",v28.OpportunityBuff)<(1 + 1)))) then local v88=438 -(262 + 176) ;while true do if (v88==(1721 -(345 + 1376))) then v20("Pistol Shot");return true;end end end v64=690 -(198 + 490) ;end if (v64==0) then if (v3(v28.Ambush) and IsPlayerSpell(v28.HiddenOpportunityTalent) and v11(v28.AudacityBuff)) then local v89=0;while true do if ((0 -0)==v89) then v20("Ambush");return true;end end end if (v3(v28.SinisterStrike) and v38 and  not v34 and (((v9(v28.EscalatingBladeBuff)>(4 -2)) and (v9(v28.OpportunityBuff)<((IsPlayerSpell(v28.FanTheHammerTalent) and (1212 -(696 + 510))) or (1 -0)))) or  not IsPlayerSpell(v28.HiddenOpportunityTalent)) and (v9(v28.EscalatingBladeBuff)<(1266 -(1091 + 171)))) then v20("Sinister Strike");return true;end v64=1;end if (v64==2) then if (v3(v28.PistolShot) and IsPlayerSpell(v28.FanTheHammerTalent) and v11(v28.OpportunityBuff) and (((v33-v32)>=(1 + 0 + ((((IsPlayerSpell(v28.QuickDrawTalent) and (3 -2)) or (0 -0)) + ((v11(v28.BroadsideBuff) and 1) or (374 -(123 + 251)))) * (v24(v28.FanTheHammerTalentNode) + (4 -3))))) or (v32<=((IsPlayerSpell(v28.RuthlessnessTalent) and (699 -(208 + 490))) or (0 + 0))))) then local v90=0 + 0 ;while true do if (v90==(836 -(660 + 176))) then v20("Pistol Shot");return true;end end end if (v3(v28.PistolShot) and  not IsPlayerSpell(v28.FanTheHammerTalent) and v11(v28.OpportunityBuff) and (((v37-v36)>(10 + 65)) or ((v33-v32)<=((203 -(14 + 188)) + ((v11(v28.BroadsideBuff) and 1) or (675 -(534 + 141))))) or IsPlayerSpell(v28.QuickDrawTalent) or (IsPlayerSpell(v28.AudacityBuff) and  not v11(v28.AudacityBuff)))) then local v91=0;while true do if (v91==(0 + 0)) then v20("Pistol Shot");return true;end end end v64=3 + 0 ;end if (v64==(4 + 0)) then if v3(v28.SinisterStrike) then local v92=0 -0 ;while true do if (v92==0) then v20("Sinister Strike");return true;end end end break;end end end;local v54=function() if v3(v28.KillingSpree) then if ((aura_env.config[tostring(v28.KillingSpree)]==true) and aura_env.FlagKTrigCD) then v21("Killing Spree");elseif (aura_env.config[tostring(v28.KillingSpree)]~=true) then v20("Killing Spree");return true;end end if (FindSpellOverrideByID(v28.Dispatch)==v28.CoupDeGrace) then local v76=0 -0 ;while true do if (v76==0) then v20("Dispatch");return true;end end end if (v3(v28.BetweenTheEyes) and (v11(v28.RuthlessPrecisionBuff) or (v5("player",v28.BetweenTheEyesBuff)<4) or  not IsPlayerSpell(v28.MeanStreakTalent)) and ( not v11(v28.GreenskinsWickersBuff) or  not IsPlayerSpell(v28.GreenskinsWickersTalent))) then local v77=0 -0 ;while true do if (v77==(0 + 0)) then v20("Between the Eyes");return true;end end end if v3(v28.Dispatch) then local v78=0 + 0 ;while true do if (v78==(396 -(115 + 281))) then v20("Dispatch");return true;end end end end;local v55=function() if (v3(v28.Vanish) and  not IsPlayerSpell(v28.KillingSpreeTalent) and  not v3(v28.BetweenTheEyes) and (v5("player",v28.RuthlessPrecisionBuff)>(9 -5)) and (((v7(v28.KeepItRolling)>(125 + 25)) and (v46>(0 -0))) or  not IsPlayerSpell(v28.KeepItRollingTalent))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v95=0 -0 ;while true do if (v95==(867 -(550 + 317))) then v20("Vanish");return true;end end end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.KillingSpreeTalent) and (GetUnitChargedPowerPoints("player")~=nil)) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and (v7(v28.KillingSpree)>(43 -13))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and ((v16(v28.Vanish)<(21 -6)) or (v18(167 -107 ,v40)<(293 -(134 + 151))))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v96=0;while true do if (0==v96) then v20("Vanish");return true;end end end end end;local v56=function() if (v3(v28.Vanish) and IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.SubterfugeTalent) and  not IsPlayerSpell(v28.CrackshotTalent) and v11(v28.AdrenalineRushBuff) and (v30.AmbushCondition or  not IsPlayerSpell(v28.HiddenOpportunityTalent)) and (( not v3(v28.BetweenTheEyes) and v11(v28.RuthlessPrecisionBuff)) or (v11(v28.RuthlessPrecisionBuff)==false) or (v5("player",v28.AdrenalineRushBuff)<3))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.CrackshotTalent) and v30.FinishCondition) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.UnderhandedUpperHandTalent) and  not IsPlayerSpell(v28.CrackshotTalent) and IsPlayerSpell(v28.HiddenOpportunityTalent) and  not v11(v28.AudacityBuff) and (v9(v28.OpportunityBuff)<((IsPlayerSpell(v28.FanTheHammerTalent) and 6) or (1666 -(970 + 695)))) and v30.AmbushCondition) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.UnderhandedUpperHandTalent) and  not IsPlayerSpell(v28.CrackshotTalent) and  not IsPlayerSpell(v28.HiddenOpportunityTalent) and IsPlayerSpell(v28.FatefulEndingTalent) and (( not v11(v28.FateboundLuckyCoinBuff) and ((v9(v28.FateboundCoinTailsBuff)>=5) or (v9(v28.FateboundCoinHeadsBuff)>=(9 -4)))) or (v11(v28.FateboundLuckyCoinBuff) and  not v3(v28.BetweenTheEyes)))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.UnderhandedUpperHandTalent) and  not IsPlayerSpell(v28.CrackshotTalent) and  not IsPlayerSpell(v28.HiddenOpportunityTalent) and  not IsPlayerSpell(v28.FatefulEndingTalent) and IsPlayerSpell(v28.TakeEmBySurpriseTalent) and  not v11(v28.TakeEmBySurpriseBuff)) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end end;local v57=function() if (v3(v28.BladeFlurry) and (v39>=2) and (v5("player",v28.BladeFlurry)<v25)) then v20("Blade Flurry");return true;end if (v3(v28.BladeFlurry) and IsPlayerSpell(v28.DeftManeuversTalent) and  not v30.FinishCondition and (v39>=(1995 -(582 + 1408))) and ( not v38 or v34 or (v9(v28.EscalatingBladeBuff)>=(13 -9)))) then local v79=0;while true do if (v79==(0 -0)) then v20("Blade Flurry");return true;end end end if (v3(v28.RollTheBones) and (v41==(0 -0))) then local v80=0;while true do if (v80==(1824 -(1195 + 629))) then v20("Roll the Bones");return true;end end end if (v3(v28.RollTheBones) and (v31>=4) and (v44<=1) and ((v30.BuffsAbovePandemic<(6 -1)) or (v42<(283 -(187 + 54))))) then local v81=780 -(162 + 618) ;while true do if (0==v81) then v20("Roll the Bones");return true;end end end if (v3(v28.RollTheBones) and (v31>=(3 + 1)) and ((v41<=(2 + 0)) or (((v42<(23 -12)) or  not IsPlayerSpell(v28.KeepItRolling)) and (v44<(8 -3)) and IsPlayerSpell(v28.SuperchargerTalent)))) then v20("Roll the Bones");return true;end if (v3(v28.RollTheBones) and  not (v31>=(1 + 3)) and ((v44<=((v11(v28.LoadedDiceBuff) and (1637 -(1373 + 263))) or 0)) or (IsPlayerSpell(v28.SuperchargerTalent) and v11(v28.LoadedDiceBuff) and (v41<=(1002 -(451 + 549)))) or (IsPlayerSpell(v28.HiddenOpportunityTalent) and v11(v28.LoadedDiceBuff) and (v41<=(1 + 1)) and  not v11(v28.BroadsideBuff) and  not v11(v28.RuthlessPrecisionBuff) and  not v11(v28.TrueBearingBuff)))) then v20("Roll the Bones");return true;end if (v3(v28.Vanish) and IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.SubterfugeTalent) and v11(v28.AdrenalineRushBuff) and  not v34 and (v5("player",v28.AdrenalineRushBuff)<(2 -0)) and (v7(v28.AdrenalineRush)>(50 -20))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v97=0;while true do if (v97==(1384 -(746 + 638))) then v20("Vanish");return true;end end end end if ( not v34 and ((v3(v28.KillingSpree) and IsPlayerSpell(v28.KillingSpreeTalent)) or (v9(v28.EscalatingBladeBuff)>=(2 + 2))) and v30.FinishCondition) then local v82=0 -0 ;while true do if (0==v82) then v54();return true;end end end if ( not v34 and IsPlayerSpell(v28.CrackshotTalent) and IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.SubterfugeTalent) and v11(v28.AdrenalineRushBuff) and v30.FinishCondition) then if v55() then return true;end end if ( not v34 and ( not IsPlayerSpell(v28.UnderhandedUpperHandTalent) or  not IsPlayerSpell(v28.CrackshotTalent) or  not IsPlayerSpell(v28.SubterfugeTalent))) then if v56() then return true;end end if (v3(v28.BladeRush) and (v36<v26) and  not v34) then local v83=0;while true do if (v83==(341 -(218 + 123))) then v20("Blade Rush");return true;end end end end;local v58=function() local v65=1581 -(1535 + 46) ;while true do if ((1 + 0)==v65) then if (v3(v28.PistolShot) and IsPlayerSpell(v28.CrackshotTalent) and (v24(v28.FanTheHammerTalentNode)>(1 + 0)) and (v9(v28.OpportunityBuff)>=(566 -(306 + 254))) and ((v11(v28.BroadsideBuff) and (v32<=(1 + 0))) or v11(v28.GreenskinsWickersBuff))) then local v93=0 -0 ;while true do if ((1467 -(899 + 568))==v93) then v20("Pistol Shot");return true;end end end if (v3(v28.Ambush) and (IsPlayerSpell(v28.HiddenOpportunityTalent))) then v20("Ambush");return true;end break;end if (v65==(0 + 0)) then if (v3(v28.BetweenTheEyes) and v30.FinishCondition and IsPlayerSpell(v28.CrackshotTalent) and ( not v11(v28.Shadowmeld) or v34)) then v20("Between the Eyes");return true;end if (v3(v28.Dispatch) and v30.FinishCondition) then local v94=0;while true do if (v94==(0 -0)) then v20("Dispatch");return true;end end end v65=604 -(268 + 335) ;end end end;if v57() then return true;end if v34 then if v58() then return true;end end if v30.FinishCondition then local v74=290 -(60 + 230) ;while true do if ((572 -(426 + 146))==v74) then v54();return true;end end end if v53() then return true;end end;