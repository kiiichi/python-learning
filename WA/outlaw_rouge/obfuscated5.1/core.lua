function() if (aura_env.LastUpdate and (aura_env.LastUpdate>(GetTime() -aura_env.config['UpdateFrequency']))) then return;end aura_env.LastUpdate=GetTime();local v2=GetTime();local v3=aura_env.OffCooldown;local v4=aura_env.OffCooldownNotCasting;local v5=aura_env.GetRemainingAuraDuration;local v6=aura_env.GetRemainingDebuffDuration;local v7=aura_env.GetRemainingSpellCooldown;local v8=aura_env.IsCasting;local v9=aura_env.GetPlayerStacks;local v10=aura_env.GetTargetStacks;local v11=aura_env.PlayerHasBuff;local v12=aura_env.TargetHasDebuff;local v13=aura_env.HasBloodlust;local v14=aura_env.GetSpellChargesFractional;local v15=aura_env.GetTimeToNextCharge;local v16=aura_env.GetTimeToFullCharges;local v17=aura_env.TargetTimeToXPct;local v18=aura_env.FightRemains;local v19=aura_env.IsAuraRefreshable;local v20=aura_env.KTrig;local v21=aura_env.KTrigCD;aura_env.FlagKTrigCD=true;local v23=aura_env.FullGCD;local v24=aura_env.TalentRank;local v25=1 + 0 ;local v26=80 -(5 + 25) ;local v27=84 -34 ;local v28=aura_env.ids;aura_env.OutOfRange=false;local v30={};local v31=WeakAuras.GetNumSetItemsEquipped(3063 -(1069 + 118) );local v32=UnitPower("player",Enum.PowerType.ComboPoints);local v33=UnitPowerMax("player",Enum.PowerType.ComboPoints);local v34=v11(v28.SubterfugeBuff) or v11(v28.Stealth) or v11(v28.VanishBuff) ;local v35=v32;local v36=UnitPower("player",Enum.PowerType.Energy);local v37=UnitPowerMax("player",Enum.PowerType.Energy);local v38=aura_env.DisorientingStrikesCount>(0 -0) ;local v39=1000 -(451 + 549) ;local v40=17 -9 ;local v41=0 + 0 ;local v42=3 + 9 ;for v61=1,71 -31  do local v62=0 + 0 ;local v63;while true do if (v62==(792 -(368 + 423))) then if (UnitExists(v63) and (UnitIsFriend("player",v63)==false) and WeakAuras.CheckRange(v63,v42,"<=")) then v41=v41 + (3 -2) ;end break;end if (v62==0) then v63="nameplate"   .. v61 ;if (UnitExists(v63) and (UnitIsFriend("player",v63)==false) and WeakAuras.CheckRange(v63,v40,"<=")) then v39=v39 + (19 -(10 + 8)) ;end v62=3 -2 ;end end end WeakAuras.ScanEvents("K_NEARBY_ENEMIES",v39);WeakAuras.ScanEvents("K_FURTHER_ENEMIES",v41);local v43=341 -(218 + 123) ;local v44=442 -(416 + 26) ;local v45=0 -0 ;local v46=0 + 0 ;local v47=0 + 0 ;local v48=0 -0 ;local v49=max(aura_env.RTBContainerExpires-GetTime() ,0);local v50={193786 -(44 + 386) ,61428 + 131929 ,194130 -(201 + 571) ,805005 -611646 ,728677 -529077 ,200462 -(814 + 45) };for v64,v65 in ipairs(v50) do if v11(v65) then local v78=0 -0 ;while true do if (v78==(1 + 0)) then v45=((v45==(0 + 0)) and v5("player",v65)) or math.min(v45,v5("player",v65)) ;if (v5("player",v65)>(v49 + (885.3 -(261 + 624)))) then v47=v47 + 1 + 0 ;else if (v5("player",v65)>(v49-(0.3 -0))) then v48=v48 + (1081 -(1020 + 60)) ;end v46=v46 + (1424 -(630 + 793)) ;end break;end if (v78==(0 -0)) then v43=v43 + 1 ;v44=math.max(v44,v5("player",v65));v78=4 -3 ;end end end end v30.AmbushCondition=(IsPlayerSpell(v28.HiddenOpportunityTalent) or ((v33-v32)>=(1 + 1 + ((IsPlayerSpell(v28.ImprovedAmbushTalent) and (3 -2)) or (1747 -(760 + 987))) + ((v11(v28.BroadsideBuff) and (1252 -(721 + 530))) or (1913 -(1789 + 124)))))) and (v36>=(816 -(745 + 21))) ;v30.FinishCondition=v32>=((v33-(1 + 0)) -((((v34 and IsPlayerSpell(v28.CrackshotTalent)) or ((IsPlayerSpell(v28.HandOfFateTalent) or IsPlayerSpell(v28.FlawlessFormTalent)) and IsPlayerSpell(v28.HiddenOpportunityTalent) and (v11(v28.AudacityBuff) or v11(v28.OpportunityBuff)))) and (701 -(271 + 429))) or (0 + 0))) ;v30.BuffsAbovePandemic=(((v5("player",v28.BroadsideBuff)>(1539 -(1408 + 92))) and (1087 -(461 + 625))) or (0 + 0)) + (((v5("player",v28.RuthlessPrecisionBuff)>(106 -67)) and (1172 -(418 + 753))) or (0 -0)) + (((v5("player",v28.TrueBearingBuff)>(5 + 34)) and (1 + 0)) or 0) + (((v5("player",v28.GrandMeleeBuff)>(31 + 8)) and 1) or (1055 -(87 + 968))) + (((v5("player",v28.BuriedTreasureBuff)>(171 -132)) and (1 + 0)) or (0 + 0)) + (((v5("player",v28.SkullAndCrossbonesBuff)>(87 -48)) and (1414 -(447 + 966))) or (0 -0)) ;local v54={};if aura_env.config['NeedTarget'] then if ((UnitExists("target")==false) or (UnitCanAttack("player","target")==false)) then WeakAuras.ScanEvents("K_TRIGED_EXTRA",v54);v20("Clear",nil);v21("Clear",nil);return;end end if (v3(v28.AdrenalineRush) and  not v11(v28.AdrenalineRush) and ( not v30.FinishCondition or  not IsPlayerSpell(v28.ImprovedAdrenalineRushTalent))) then v54.AdrenalineRush=true;end if (v3(v28.AdrenalineRush) and v11(v28.AdrenalineRush) and IsPlayerSpell(v28.ImprovedAdrenalineRushTalent) and (v32<=(1819 -(1703 + 114)))) then v54.AdrenalineRush=true;end if (v3(v28.GhostlyStrike) and ((v32<v33) or (v24(v28.FanTheHammerTalentNode)>(702 -(376 + 325))))) then v54.GhostlyStrike=true;end if (v3(v28.ThistleTea) and  not v11(v28.ThistleTea) and ((v36<aura_env.config['ThistleTeaEnergy']) or (v17(0 -0 ,999)<(C_Spell.GetSpellCharges(v28.ThistleTea).currentCharges * (18 -12))))) then v54.ThistleTea=true;end if (v3(v28.KeepItRolling) and (v48>=(2 + 3)) and (v43==(12 -6))) then v54.KeepItRolling=true;end if (v3(v28.KeepItRolling) and (v43>=(18 -(9 + 5))) and (v48<=2)) then v54.KeepItRolling=true;end if (v3(v28.KeepItRolling) and (v43>=(379 -(85 + 291))) and (v48<=(1267 -(243 + 1022))) and v11(v28.BroadsideBuff) and v11(v28.RuthlessPrecisionBuff) and v11(v28.TrueBearingBuff)) then v54.KeepItRolling=true;end if v3(v28.ColdBlood) then v54.ColdBlood=true;end WeakAuras.ScanEvents("K_TRIGED_EXTRA",v54,nil);local v55=function() local v66=0 -0 ;while true do if (v66==(2 -1)) then if (v3(v28.PistolShot) and IsPlayerSpell(v28.FanTheHammerTalent) and IsPlayerSpell(v28.AudacityBuff) and IsPlayerSpell(v28.HiddenOpportunityTalent) and v11(v28.OpportunityBuff) and  not v11(v28.AudacityBuff)) then v20("Pistol Shot");return true;end if (v3(v28.BladeFlurry) and IsPlayerSpell(v28.DeftManeuversTalent) and (v39>=(10 -6)) and ((v32<=2) or  not v11(v28.AdrenalineRushBuff))) then v20("Blade Flurry");return true;end v66=116 -(4 + 110) ;end if (v66==(0 + 0)) then if (v3(v28.Ambush) and IsPlayerSpell(v28.HiddenOpportunityTalent) and v11(v28.AudacityBuff)) then v20("Ambush");return true;end if (v3(v28.SinisterStrike) and v38 and  not v34 and (((v9(v28.EscalatingBladeBuff)>(1429 -(41 + 1386))) and (v9(v28.OpportunityBuff)<((IsPlayerSpell(v28.FanTheHammerTalent) and (1186 -(1123 + 57))) or (1 + 0)))) or  not IsPlayerSpell(v28.HiddenOpportunityTalent)) and (v9(v28.EscalatingBladeBuff)<4)) then local v83=254 -(163 + 91) ;while true do if (v83==(1930 -(1869 + 61))) then v20("Sinister Strike");return true;end end end v66=1;end if (v66==(8 -4)) then if (v3(v28.Ambush) and (IsPlayerSpell(v28.HiddenOpportunityTalent))) then local v84=0 + 0 ;while true do if ((0 -0)==v84) then v20("Ambush");return true;end end end if v3(v28.SinisterStrike) then local v85=0 -0 ;while true do if (v85==(0 -0)) then v20("Sinister Strike");return true;end end end break;end if (v66==(6 -4)) then if (v3(v28.PistolShot) and (v24(v28.FanTheHammerTalentNode)>(1 + 0)) and v11(v28.OpportunityBuff) and ((v9(v28.OpportunityBuff)>=((IsPlayerSpell(v28.FanTheHammerTalent) and (7 -1)) or (1 + 0))) or (v5("player",v28.OpportunityBuff)<(1476 -(1329 + 145))))) then v20("Pistol Shot");return true;end if (v3(v28.PistolShot) and IsPlayerSpell(v28.FanTheHammerTalent) and v11(v28.OpportunityBuff) and (((v33-v32)>=((972 -(140 + 831)) + ((((IsPlayerSpell(v28.QuickDrawTalent) and (1851 -(1409 + 441))) or (718 -(15 + 703))) + ((v11(v28.BroadsideBuff) and 1) or (0 + 0))) * (v24(v28.FanTheHammerTalentNode) + 1 + 0)))) or (v32<=((IsPlayerSpell(v28.RuthlessnessTalent) and (1258 -(1043 + 214))) or (0 -0))))) then local v86=0;while true do if (v86==(438 -(262 + 176))) then v20("Pistol Shot");return true;end end end v66=1724 -(345 + 1376) ;end if (v66==(691 -(198 + 490))) then if (v3(v28.PistolShot) and  not IsPlayerSpell(v28.FanTheHammerTalent) and v11(v28.OpportunityBuff) and (((v37-v36)>(201 -126)) or ((v33-v32)<=(1 + ((v11(v28.BroadsideBuff) and (4 -3)) or (0 -0)))) or IsPlayerSpell(v28.QuickDrawTalent) or (IsPlayerSpell(v28.AudacityBuff) and  not v11(v28.AudacityBuff)))) then v20("Pistol Shot");return true;end if ((FindSpellOverrideByID(v28.Dispatch)==v28.CoupDeGrace) and  not v34) then v20("Dispatch");return true;end v66=1210 -(696 + 510) ;end end end;local v56=function() local v67=0 -0 ;while true do if (1==v67) then if (v3(v28.BetweenTheEyes) and (v11(v28.RuthlessPrecisionBuff) or (v5("player",v28.BetweenTheEyesBuff)<(1 + 3)) or  not IsPlayerSpell(v28.MeanStreakTalent)) and ( not v11(v28.GreenskinsWickersBuff) or  not IsPlayerSpell(v28.GreenskinsWickersTalent))) then v20("Between the Eyes");return true;end if v3(v28.Dispatch) then v20("Dispatch");return true;end break;end if (v67==(1262 -(1091 + 171))) then if v3(v28.KillingSpree) then if ((aura_env.config[tostring(v28.KillingSpree)]==true) and aura_env.FlagKTrigCD) then v21("Killing Spree");elseif (aura_env.config[tostring(v28.KillingSpree)]~=true) then local v93=982 -(18 + 964) ;while true do if (v93==(0 + 0)) then v20("Killing Spree");return true;end end end end if (FindSpellOverrideByID(v28.Dispatch)==v28.CoupDeGrace) then v20("Dispatch");return true;end v67=3 -2 ;end end end;local v57=function() local v68=0 -0 ;while true do if (v68==(374 -(123 + 251))) then if (v3(v28.Vanish) and  not IsPlayerSpell(v28.KillingSpreeTalent) and  not v3(v28.BetweenTheEyes) and (v5("player",v28.RuthlessPrecisionBuff)>(19 -15)) and (((v7(v28.KeepItRolling)>150) and (v48>(698 -(208 + 490)))) or  not IsPlayerSpell(v28.KeepItRollingTalent))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.KillingSpreeTalent) and (GetUnitChargedPowerPoints("player")~=nil)) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end v68=1 + 0 ;end if (v68==(739 -(542 + 196))) then if (v3(v28.Vanish) and (v7(v28.KillingSpree)>(14 + 16))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and ((v16(v28.Vanish)<(851 -(660 + 176))) or (v18(18 + 42 ,v40)<(5 + 3)))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end break;end end end;local v58=function() if (v3(v28.Vanish) and IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.SubterfugeTalent) and  not IsPlayerSpell(v28.CrackshotTalent) and v11(v28.AdrenalineRushBuff) and (v30.AmbushCondition or  not IsPlayerSpell(v28.HiddenOpportunityTalent)) and (( not v3(v28.BetweenTheEyes) and v11(v28.RuthlessPrecisionBuff)) or (v11(v28.RuthlessPrecisionBuff)==false) or (v5("player",v28.AdrenalineRushBuff)<(1 + 2)))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.CrackshotTalent) and v30.FinishCondition) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v90=202 -(14 + 188) ;while true do if (v90==(675 -(534 + 141))) then v20("Vanish");return true;end end end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.UnderhandedUpperHandTalent) and  not IsPlayerSpell(v28.CrackshotTalent) and IsPlayerSpell(v28.HiddenOpportunityTalent) and  not v11(v28.AudacityBuff) and (v9(v28.OpportunityBuff)<((IsPlayerSpell(v28.FanTheHammerTalent) and 6) or (2 -1))) and v30.AmbushCondition) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.UnderhandedUpperHandTalent) and  not IsPlayerSpell(v28.CrackshotTalent) and  not IsPlayerSpell(v28.HiddenOpportunityTalent) and IsPlayerSpell(v28.FatefulEndingTalent) and (( not v11(v28.FateboundLuckyCoinBuff) and ((v9(v28.FateboundCoinTailsBuff)>=(3 + 2)) or (v9(v28.FateboundCoinHeadsBuff)>=(5 + 0)))) or (v11(v28.FateboundLuckyCoinBuff) and  not v3(v28.BetweenTheEyes)))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v91=0 + 0 ;while true do if (v91==(0 -0)) then v20("Vanish");return true;end end end end if (v3(v28.Vanish) and  not IsPlayerSpell(v28.UnderhandedUpperHandTalent) and  not IsPlayerSpell(v28.CrackshotTalent) and  not IsPlayerSpell(v28.HiddenOpportunityTalent) and  not IsPlayerSpell(v28.FatefulEndingTalent) and IsPlayerSpell(v28.TakeEmBySurpriseTalent) and  not v11(v28.TakeEmBySurpriseBuff)) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then v20("Vanish");return true;end end end;local v59=function() if (v3(v28.BladeFlurry) and (v39>=(2 -0)) and (v5("player",v28.BladeFlurry)<v25)) then local v79=0 -0 ;while true do if (v79==(0 + 0)) then v20("Blade Flurry");return true;end end end if (v3(v28.RollTheBones) and (v43==(0 + 0))) then v20("Roll the Bones");return true;end if (v3(v28.RollTheBones) and (v31>=4) and (v46<=(397 -(115 + 281))) and ((v30.BuffsAbovePandemic<(11 -6)) or (v44<(35 + 7)))) then local v80=0 -0 ;while true do if (v80==(0 -0)) then v20("Roll the Bones");return true;end end end if (v3(v28.RollTheBones) and (v31>=(871 -(550 + 317))) and ((v43<=2) or (((v44<(15 -4)) or  not IsPlayerSpell(v28.KeepItRolling)) and (v46<(7 -2)) and IsPlayerSpell(v28.SuperchargerTalent)))) then local v81=0 -0 ;while true do if (v81==0) then v20("Roll the Bones");return true;end end end if (v3(v28.RollTheBones) and  not (v31>=(11 -7)) and ((v46<=((v11(v28.LoadedDiceBuff) and (286 -(134 + 151))) or (1665 -(970 + 695)))) or (IsPlayerSpell(v28.SuperchargerTalent) and v11(v28.LoadedDiceBuff) and (v43<=2)) or (IsPlayerSpell(v28.HiddenOpportunityTalent) and v11(v28.LoadedDiceBuff) and (v43<=(3 -1)) and  not v11(v28.BroadsideBuff) and  not v11(v28.RuthlessPrecisionBuff) and  not v11(v28.TrueBearingBuff)))) then v20("Roll the Bones");return true;end if (v3(v28.Vanish) and IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.SubterfugeTalent) and v11(v28.AdrenalineRushBuff) and  not v34 and (v5("player",v28.AdrenalineRushBuff)<(2 + 0)) and (v7(v28.AdrenalineRush)>(18 + 12))) then if ((aura_env.config[tostring(v28.Vanish)]==true) and aura_env.FlagKTrigCD) then v21("Vanish");elseif (aura_env.config[tostring(v28.Vanish)]~=true) then local v92=0 + 0 ;while true do if (v92==(1990 -(582 + 1408))) then v20("Vanish");return true;end end end end if ( not v34 and ((v3(v28.KillingSpree) and IsPlayerSpell(v28.KillingSpreeTalent)) or (v9(v28.EscalatingBladeBuff)>=(13 -9))) and v30.FinishCondition) then local v82=0 -0 ;while true do if (v82==(0 -0)) then v56();return true;end end end if ( not v34 and IsPlayerSpell(v28.CrackshotTalent) and IsPlayerSpell(v28.UnderhandedUpperHandTalent) and IsPlayerSpell(v28.SubterfugeTalent) and v11(v28.AdrenalineRushBuff) and v30.FinishCondition) then if v57() then return true;end end if ( not v34 and ( not IsPlayerSpell(v28.UnderhandedUpperHandTalent) or  not IsPlayerSpell(v28.CrackshotTalent) or  not IsPlayerSpell(v28.SubterfugeTalent))) then if v58() then return true;end end if (v3(v28.BladeRush) and (v36<v26) and  not v34) then v20("Blade Rush");return true;end end;local v60=function() local v69=0 + 0 ;while true do if (v69==(0 -0)) then if (v3(v28.BetweenTheEyes) and v30.FinishCondition and IsPlayerSpell(v28.CrackshotTalent) and ( not v11(v28.Shadowmeld) or v34)) then v20("Between the Eyes");return true;end if (v3(v28.Dispatch) and v30.FinishCondition) then local v87=753 -(239 + 514) ;while true do if (v87==(1824 -(1195 + 629))) then v20("Dispatch");return true;end end end v69=1 -0 ;end if (v69==(242 -(187 + 54))) then if (v3(v28.PistolShot) and IsPlayerSpell(v28.CrackshotTalent) and (v24(v28.FanTheHammerTalentNode)>1) and (v9(v28.OpportunityBuff)>=(3 + 3)) and ((v11(v28.BroadsideBuff) and (v32<=(781 -(162 + 618)))) or v11(v28.GreenskinsWickersBuff))) then local v88=1202 -(373 + 829) ;while true do if (v88==(0 + 0)) then v20("Pistol Shot");return true;end end end if (v3(v28.Ambush) and (IsPlayerSpell(v28.HiddenOpportunityTalent))) then local v89=0 + 0 ;while true do if ((0 + 0)==v89) then v20("Ambush");return true;end end end break;end end end;if v59() then return true;end if v34 then if v60() then return true;end end if v30.FinishCondition then v56();return true;end if v55() then return true;end v20("Clear");end;