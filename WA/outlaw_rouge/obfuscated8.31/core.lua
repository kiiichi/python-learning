function() if (aura_env.LastUpdate and (aura_env.LastUpdate>(GetTime() -aura_env.config['UpdateFrequency']))) then return;end aura_env.LastUpdate=GetTime();local v2=GetTime();local v3=aura_env.OffCooldown;local v4=aura_env.OffCooldownNotCasting;local v5=aura_env.GetRemainingAuraDuration;local v6=aura_env.GetRemainingDebuffDuration;local v7=aura_env.GetRemainingSpellCooldown;local v8=aura_env.IsCasting;local v9=aura_env.GetPlayerStacks;local v10=aura_env.GetTargetStacks;local v11=aura_env.PlayerHasBuff;local v12=aura_env.TargetHasDebuff;local v13=aura_env.HasBloodlust;local v14=aura_env.GetSpellChargesFractional;local v15=aura_env.GetTimeToNextCharge;local v16=aura_env.GetTimeToFullCharges;local v17=aura_env.TargetTimeToXPct;local v18=aura_env.FightRemains;local v19=aura_env.IsAuraRefreshable;local v20=C_SpellBook.IsSpellKnown;local v21=aura_env.KTrig;local v22=aura_env.KTrigCD;aura_env.FlagKTrigCD=true;local v24=aura_env.FullGCD;local v25=aura_env.TalentRank;local v26=1427 -(562 + 864) ;local v27=10 + 40 ;local v28=20 + 30 ;local v29=aura_env.ids;aura_env.OutOfRange=false;local v31={};local v32=WeakAuras.GetNumSetItemsEquipped(2446 -(114 + 404) );local v33=WeakAuras.GetNumSetItemsEquipped(2364 -(106 + 382) );local v34=UnitPower("player",Enum.PowerType.ComboPoints);local v35=UnitPowerMax("player",Enum.PowerType.ComboPoints);local v36=v11(v29.SubterfugeBuff) or v11(v29.Stealth) or v11(v29.VanishBuff) ;local v37=UnitPower("player",Enum.PowerType.Energy);local v38=UnitPowerMax("player",Enum.PowerType.Energy);local v39=aura_env.DisorientingStrikesCount>(411 -(306 + 105)) ;local v40=0;local v41=8;local v42=0;local v43=30 -18 ;for v62=1,467 -(166 + 261)  do local v63="nameplate"   .. v62 ;if (UnitExists(v63) and (UnitIsFriend("player",v63)==false) and WeakAuras.CheckRange(v63,v41,"<=")) then v40=v40 + 1 ;end if (UnitExists(v63) and (UnitIsFriend("player",v63)==false) and WeakAuras.CheckRange(v63,v43,"<=")) then v42=v42 + 1 ;end end WeakAuras.ScanEvents("K_NEARBY_ENEMIES",v40);WeakAuras.ScanEvents("K_FURTHER_ENEMIES",v42);local v44=507 -(289 + 218) ;local v45=1344 -(1213 + 131) ;local v46=0 + 0 ;local v47=0;local v48=0 + 0 ;local v49=0;local v50=max(aura_env.RTBContainerExpires-GetTime() ,0 -0 );local v51={686624 -493268 ,193357,10420 + 182938 ,194244 -(261 + 624) ,200680 -(1020 + 60) ,199603};for v64,v65 in ipairs(v51) do if v11(v65) then local v75=0;while true do if (v75==(1423 -(630 + 793))) then v44=v44 + 1 ;v45=math.max(v45,v5("player",v65));v75=1;end if (v75==1) then v46=((v46==0) and v5("player",v65)) or math.min(v46,v5("player",v65)) ;if (v5("player",v65)>(v50 + (0.3 -0))) then v48=v48 + 1 ;else if (v5("player",v65)>(v50-0.3)) then v49=v49 + (4 -3) ;end v47=v47 + 1 ;end break;end end end end v31.AmbushCondition=(v20(v29.HiddenOpportunityTalent) or ((v35-v34)>=(2 + ((v20(v29.ImprovedAmbushTalent) and (1 + 0)) or (0 -0)) + ((v11(v29.BroadsideBuff) and (1748 -(760 + 987))) or (1913 -(1789 + 124)))))) and (v37>=(816 -(745 + 21))) ;v31.FinishCondition=v34>=((v35-(1 + 0)) -((((v36 and v20(v29.CrackshotTalent)) or ((v20(v29.HandOfFateTalent) or v20(v29.UnseenBladeTalent)) and v20(v29.HiddenOpportunityTalent) and (v11(v29.AudacityBuff) or v11(v29.OpportunityBuff)))) and (2 -1)) or 0)) ;v31.BuffsAbovePandemic=(((v5("player",v29.BroadsideBuff)>39) and 1) or 0) + (((v5("player",v29.RuthlessPrecisionBuff)>39) and (3 -2)) or (0 + 0)) + (((v5("player",v29.TrueBearingBuff)>39) and 1) or (0 + 0)) + (((v5("player",v29.GrandMeleeBuff)>(1094 -(87 + 968))) and (4 -3)) or (0 + 0)) + (((v5("player",v29.BuriedTreasureBuff)>(87 -48)) and (1414 -(447 + 966))) or (0 -0)) + (((v5("player",v29.SkullAndCrossbonesBuff)>(1856 -(1703 + 114))) and 1) or (701 -(376 + 325))) ;local v55={};if aura_env.config['NeedTarget'] then if ((UnitExists("target")==false) or (UnitCanAttack("player","target")==false)) then local v87=0 -0 ;while true do if (v87==1) then v22("Clear",nil);return;end if (v87==(0 -0)) then WeakAuras.ScanEvents("K_TRIGED_EXTRA",v55);v21("Clear",nil);v87=1;end end end end if (v3(v29.AdrenalineRush) and (( not v11(v29.AdrenalineRush) and ( not v31.FinishCondition or  not v20(v29.ImprovedAdrenalineRushTalent))) or (v11(v29.AdrenalineRushBuff) and (v34<=2) and ((v14(v29.Vanish)<(1 + 0)) or  not ((v32>=2) and v20(v29.HandOfFateTalent)))))) then v55.AdrenalineRush=true;end if (v3(v29.GhostlyStrike) and ((v20(v29.HandOfFateTalent) and ((v14(v29.Vanish)<(2 -1)) or  not ((v32>=(16 -(9 + 5))) and v20(v29.HandOfFateTalent)))) or (v20(v29.UnseenBladeTalent) and ((v34<v35) or v20(v29.FanTheHammerTalent))))) then v55.GhostlyStrike=true;end if (v3(v29.ThistleTea) and  not v11(v29.ThistleTea) and ((v37<v28) or (v17(0,1375 -(85 + 291) )<(C_Spell.GetSpellCharges(v29.ThistleTea).currentCharges * (1271 -(243 + 1022)))))) then v55.ThistleTea=true;end if (v3(v29.KeepItRolling) and (((v44>=(14 -10)) and (v49<=(2 + 0))) or ((v49>=(1185 -(1123 + 57))) and (v44==6)))) then v55.KeepItRolling=true;end if (v3(v29.KeepItRolling) and (v44>=(3 + 0)) and (v49<=2) and (v11(v29.BroadsideBuff) or v11(v29.RuthlessPrecisionBuff)) and v11(v29.TrueBearingBuff)) then v55.KeepItRolling=true;end if v3(v29.ColdBlood) then v55.ColdBlood=true;end WeakAuras.ScanEvents("K_TRIGED_EXTRA",v55,nil);local v56=function() if (v3(v29.Ambush) and IsPlayerSpell(v29.HiddenOpportunityTalent) and v11(v29.AudacityBuff)) then local v76=254 -(163 + 91) ;while true do if (v76==(1930 -(1869 + 61))) then v21("Ambush");return true;end end end if (v3(v29.SinisterStrike) and v39 and  not v36 and  not v20(v29.HiddenOpportunityTalent) and (v9(v29.EscalatingBladeBuff)<4) and  not aura_env.HasTww34PcTricksterBuff) then local v77=0 + 0 ;while true do if (v77==0) then v21("Sinister Strike");return true;end end end if (v3(v29.PistolShot) and v20(v29.FanTheHammerTalent) and v20(v29.AudacityBuff) and v20(v29.HiddenOpportunityTalent) and v11(v29.OpportunityBuff) and  not v11(v29.AudacityBuff)) then local v78=0 -0 ;while true do if (v78==0) then v21("Pistol Shot");return true;end end end if (v3(v29.BladeFlurry) and v20(v29.DeftManeuversTalent) and (v40>=4) and ((v34<=(2 -0)) or  not v11(v29.AdrenalineRushBuff) or  not v20(v29.UnseenBladeTalent))) then v21("Blade Flurry");return true;end if (v3(v29.BladeFlurry) and v20(v29.DeftManeuversTalent) and ((v35-v34)==(v40 + ((v11(v29.BroadsideBuff) and 1) or (0 + 0)))) and (v40>=((3 -0) -((v20(v29.HandOfFateTalent) and (1 + 0)) or 0))) and v20(v29.FanTheHammerTalent)) then local v79=1474 -(1329 + 145) ;while true do if (v79==(971 -(140 + 831))) then v21("Blade Flurry");return true;end end end if (v3(v29.PistolShot) and (v25(v29.FanTheHammerTalentNode)==(1852 -(1409 + 441))) and v11(v29.OpportunityBuff) and ((v9(v29.OpportunityBuff)>=((v20(v29.FanTheHammerTalent) and 6) or 1)) or (v5("player",v29.OpportunityBuff)<(720 -(15 + 703))))) then local v80=0 + 0 ;while true do if (v80==(438 -(262 + 176))) then v21("Pistol Shot");return true;end end end if (v3(v29.PistolShot) and v20(v29.FanTheHammerTalent) and v11(v29.OpportunityBuff) and (((v35-v34)>=(1 + ((((v20(v29.QuickDrawTalent) and (1722 -(345 + 1376))) or (688 -(198 + 490))) + ((v11(v29.BroadsideBuff) and (4 -3)) or 0)) * (v25(v29.FanTheHammerTalentNode) + (2 -1))))) or (v34<=((v20(v29.RuthlessnessTalent) and (1207 -(696 + 510))) or (0 -0))))) then local v81=1262 -(1091 + 171) ;while true do if (v81==(0 + 0)) then v21("Pistol Shot");return true;end end end if (v3(v29.PistolShot) and  not v20(v29.FanTheHammerTalent) and v11(v29.OpportunityBuff) and (((v38-v37)>(236 -161)) or ((v35-v34)<=(1 + ((v11(v29.BroadsideBuff) and 1) or 0))) or v20(v29.QuickDrawTalent) or (v20(v29.AudacityBuff) and  not v11(v29.AudacityBuff)))) then local v82=0;while true do if (v82==(0 -0)) then v21("Pistol Shot");return true;end end end if ((FindSpellOverrideByID(v29.Dispatch)==v29.CoupDeGrace) and  not v36) then v21("Dispatch");return true;end if (v3(v29.Ambush) and (v20(v29.HiddenOpportunityTalent))) then v21("Ambush");return true;end if v3(v29.SinisterStrike) then local v83=374 -(123 + 251) ;while true do if (v83==(0 -0)) then v21("Sinister Strike");return true;end end end end;local v57=function() if v3(v29.KillingSpree) then if ((aura_env.config[tostring(v29.KillingSpree)]==true) and aura_env.FlagKTrigCD) then v22("Killing Spree");elseif (aura_env.config[tostring(v29.KillingSpree)]~=true) then v21("Killing Spree");return true;end end if (FindSpellOverrideByID(v29.Dispatch)==v29.CoupDeGrace) then local v84=698 -(208 + 490) ;while true do if (v84==(0 + 0)) then v21("Dispatch");return true;end end end if (v3(v29.BetweenTheEyes) and (v11(v29.RuthlessPrecisionBuff) or (v5("player",v29.BetweenTheEyesBuff)<(2 + 2)) or  not v20(v29.HandOfFateTalent)) and ( not v11(v29.GreenskinsWickersBuff) or  not v20(v29.GreenskinsWickersTalent))) then local v85=836 -(660 + 176) ;while true do if (v85==(0 + 0)) then v21("Between the Eyes");return true;end end end if v3(v29.Dispatch) then v21("Dispatch");return true;end end;local v58=function() local v66=202 -(14 + 188) ;while true do if (v66==(676 -(534 + 141))) then if (v3(v29.Vanish) and ((v20(v29.UnseenBladeTalent) and v20(v29.KillingSpreeTalent) and (v7(v29.KillingSpree)>(13 + 17)) and ((v2-aura_env.LastKillingSpree)<=(9 + 1))) or  not (v32>=(4 + 0)))) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then v21("Vanish");return true;end end if (v3(v29.Vanish) and (((v16(v29.Vanish)<(31 -16)) and ( not ((v32>=(2 -0)) and v20(v29.HandOfFateTalent)) or  not v20(v29.GhostlyStrike))) or (v18(168 -108 ,v41)<(v14(v29.Vanish) * (5 + 3))))) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then local v96=0 + 0 ;while true do if (v96==(396 -(115 + 281))) then v21("Vanish");return true;end end end end break;end if (v66==0) then if (v3(v29.Vanish) and (v32>=(4 -2)) and v20(v29.HandOfFateTalent) and v3(v29.GhostlyStrike) and v20(v29.GhostlyStrike)) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then local v97=0;while true do if (v97==0) then v21("Vanish");return true;end end end end if (v3(v29.Vanish) and (v20(v29.HandOfFateTalent) or  not v20(v29.KillingSpreeTalent)) and (( not v3(v29.BetweenTheEyes) and (v5("player",v29.RuthlessPrecisionBuff)>(4 + 0))) or (GetUnitChargedPowerPoints("player")~=nil)) and ( not ((v32>=2) and v20(v29.HandOfFateTalent)) or  not v20(v29.GhostlyStrike))) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then v21("Vanish");return true;end end v66=1;end end end;local v59=function() local v67=0;while true do if ((0 -0)==v67) then if (v3(v29.RollTheBones) and ((v33>=4) or v20(v29.SleightOfHandTalent) or v20(v29.SuperchargerTalent)) and (v47<=(3 -2)) and ((v31.BuffsAbovePandemic<(872 -(550 + 317))) or (v45<(60 -18)) or (v33<(4 -0)))) then local v88=0;while true do if (v88==(0 -0)) then v21("Roll the Bones");return true;end end end if (v3(v29.RollTheBones) and ((v33>=(289 -(134 + 151))) or (v20(v29.SuperchargerTalent) and (v11(v29.LoadedDiceBuff) or (v20(v29.SleightOfHandTalent) and  not v20(v29.KeepItRollingTalent))))) and (v44<=(1667 -(970 + 695)))) then local v89=0 -0 ;while true do if ((1990 -(582 + 1408))==v89) then v21("Roll the Bones");return true;end end end v67=3 -2 ;end if ((1 -0)==v67) then if (v3(v29.RollTheBones) and (v33>=(15 -11)) and (v47<5) and ((v45<(1835 -(1195 + 629))) or  not v20(v29.KeepItRollingTalent))) then local v90=0 -0 ;while true do if (v90==(241 -(187 + 54))) then v21("Roll the Bones");return true;end end end if (v3(v29.RollTheBones) and  not (v33>=(784 -(162 + 618))) and  not v20(v29.KeepItRollingTalent) and  not v20(v29.SuperchargerTalent) and v11(v29.LoadedDiceBuff) and (v44<=(2 + 0)) and  not v11(v29.BroadsideBuff) and  not v11(v29.RuthlessPrecisionBuff) and  not v11(v29.TrueBearingBuff)) then local v91=0;while true do if (v91==(0 + 0)) then v21("Roll the Bones");return true;end end end break;end end end;local v60=function() if (v3(v29.BladeFlurry) and (v40>=2) and (v5("player",v29.BladeFlurry)<v26)) then local v86=0 -0 ;while true do if (v86==(0 -0)) then v21("Blade Flurry");return true;end end end if v59() then return true;end if (v3(v29.Vanish) and v20(v29.UnderhandedUpperHandTalent) and v20(v29.SubterfugeTalent) and v11(v29.AdrenalineRushBuff) and  not v36 and (v5("player",v29.AdrenalineRushBuff)<2) and (v7(v29.AdrenalineRush)>30)) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then local v95=0 + 0 ;while true do if (v95==(1636 -(1373 + 263))) then v21("Vanish");return true;end end end end if ( not v36 and ((v3(v29.KillingSpree) and v20(v29.KillingSpreeTalent)) or (v9(v29.EscalatingBladeBuff)>=4) or aura_env.HasTww34PcTricksterBuff) and v31.FinishCondition) then v57();return true;end if ( not v36 and v20(v29.CrackshotTalent) and v20(v29.UnderhandedUpperHandTalent) and v20(v29.SubterfugeTalent) and ((v11(v29.AdrenalineRushBuff) and v31.FinishCondition and ( not v3(v29.AdrenalineRush) or  not ((v32>=2) and v20(v29.HandOfFateTalent)))) or ((v32>=(1002 -(451 + 549))) and v20(v29.HandOfFateTalent) and v3(v29.AdrenalineRush) and (v34<=(1 + 1))))) then if v58() then return true;end end if (v3(v29.Vanish) and  not v36 and (v31.FinishCondition or  not v20(v29.CrackshotTalent)) and ( not v20(v29.UnderhandedUpperHandTalent) or  not v20(v29.SubterfugeTalent) or  not v20(v29.CrackshotTalent)) and ((v11(v29.AdrenalineRushBuff) and v20(v29.SubterfugeTalent) and v20(v29.UnderhandedUpperHandTalent)) or (( not v20(v29.SubterfugeTalent) or  not v20(v29.UnderhandedUpperHandTalent)) and v20(v29.HiddenOpportunityTalent) and  not v11(v29.AudacityBuff) and (v9(v29.OpportunityBuff)<((v20(v29.FanTheHammerTalent) and 6) or (1 -0))) and v31.AmbushCondition) or ( not v20(v29.HiddenOpportunityTalent) and (v20(v29.TakeEmBySurpriseTalent) or v20(v29.DoubleJeopardyTalent))))) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then v21("Vanish");return true;end end if (v3(v29.BladeRush) and (v37<v27) and  not v36) then v21("Blade Rush");return true;end end;local v61=function() local v68=0 -0 ;while true do if (1==v68) then if (v3(v29.PistolShot) and v20(v29.CrackshotTalent) and (v25(v29.FanTheHammerTalentNode)>1) and (v9(v29.OpportunityBuff)>=(1390 -(746 + 638))) and ((v11(v29.BroadsideBuff) and (v34<=1)) or v11(v29.GreenskinsWickersBuff))) then local v92=0;while true do if (v92==(0 + 0)) then v21("Pistol Shot");return true;end end end if (v3(v29.Ambush) and (v20(v29.HiddenOpportunityTalent))) then v21("Ambush");return true;end break;end if (v68==0) then if (v3(v29.BetweenTheEyes) and v31.FinishCondition and v20(v29.CrackshotTalent) and ( not v11(v29.Shadowmeld) or v36)) then local v93=0 -0 ;while true do if (v93==(341 -(218 + 123))) then v21("Between the Eyes");return true;end end end if (v3(v29.Dispatch) and v31.FinishCondition) then local v94=0;while true do if (v94==(1581 -(1535 + 46))) then v21("Dispatch");return true;end end end v68=1 + 0 ;end end end;if v60() then return true;end if v36 then if v61() then return true;end end if v31.FinishCondition then v57();return true;end if v56() then return true;end v21("Clear");end;