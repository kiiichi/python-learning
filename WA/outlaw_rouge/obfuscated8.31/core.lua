function() if (aura_env.LastUpdate and (aura_env.LastUpdate>(GetTime() -aura_env.config['UpdateFrequency']))) then return;end aura_env.LastUpdate=GetTime();local v2=GetTime();local v3=aura_env.OffCooldown;local v4=aura_env.OffCooldownNotCasting;local v5=aura_env.GetRemainingAuraDuration;local v6=aura_env.GetRemainingDebuffDuration;local v7=aura_env.GetRemainingSpellCooldown;local v8=aura_env.IsCasting;local v9=aura_env.GetPlayerStacks;local v10=aura_env.GetTargetStacks;local v11=aura_env.PlayerHasBuff;local v12=aura_env.TargetHasDebuff;local v13=aura_env.HasBloodlust;local v14=aura_env.GetSpellChargesFractional;local v15=aura_env.GetTimeToNextCharge;local v16=aura_env.GetTimeToFullCharges;local v17=aura_env.TargetTimeToXPct;local v18=aura_env.FightRemains;local v19=aura_env.IsAuraRefreshable;local v20=C_SpellBook.IsSpellKnown;local v21=aura_env.KTrig;local v22=aura_env.KTrigCD;aura_env.FlagKTrigCD=true;local v24=aura_env.FullGCD;local v25=aura_env.TalentRank;local v26=659 -(161 + 497) ;local v27=50;local v28=251 -(43 + 158) ;local v29=aura_env.ids;aura_env.OutOfRange=false;local v31={};local v32=WeakAuras.GetNumSetItemsEquipped(7373 -5445 );local v33=WeakAuras.GetNumSetItemsEquipped(1537 + 339 );local v34=UnitPower("player",Enum.PowerType.ComboPoints);local v35=UnitPowerMax("player",Enum.PowerType.ComboPoints);local v36=v11(v29.SubterfugeBuff) or v11(v29.Stealth) or v11(v29.VanishBuff) ;local v37=UnitPower("player",Enum.PowerType.Energy);local v38=UnitPowerMax("player",Enum.PowerType.Energy);local v39=aura_env.DisorientingStrikesCount>0 ;local v40=772 -(201 + 571) ;local v41=1146 -(116 + 1022) ;local v42=0;local v43=49 -37 ;for v62=1 + 0 ,40 do local v63="nameplate"   .. v62 ;if (UnitExists(v63) and (UnitIsFriend("player",v63)==false) and WeakAuras.CheckRange(v63,v41,"<=")) then v40=v40 + (3 -2) ;end if (UnitExists(v63) and (UnitIsFriend("player",v63)==false) and WeakAuras.CheckRange(v63,v43,"<=")) then v42=v42 + (3 -2) ;end end WeakAuras.ScanEvents("K_NEARBY_ENEMIES",v40);WeakAuras.ScanEvents("K_FURTHER_ENEMIES",v42);local v44=859 -(814 + 45) ;local v45=0 -0 ;local v46=0;local v47=0 + 0 ;local v48=0 + 0 ;local v49=885 -(261 + 624) ;local v50=max(aura_env.RTBContainerExpires-GetTime() ,0 -0 );local v51={193356,655222 -461865 ,76152 + 117206 ,195106 -(760 + 987) ,201513 -(1789 + 124) ,68657 + 130946 };for v64,v65 in ipairs(v51) do if v11(v65) then local v75=0 -0 ;while true do if (v75==1) then v46=((v46==0) and v5("player",v65)) or math.min(v46,v5("player",v65)) ;if (v5("player",v65)>(v50 + (0.3 -0))) then v48=v48 + 1 ;else if (v5("player",v65)>(v50-(0.3 + 0))) then v49=v49 + 1 ;end v47=v47 + 1 + 0 ;end break;end if (v75==(1055 -(87 + 968))) then v44=v44 + (4 -3) ;v45=math.max(v45,v5("player",v65));v75=1 + 0 ;end end end end v31.AmbushCondition=(v20(v29.HiddenOpportunityTalent) or ((v35-v34)>=((4 -2) + ((v20(v29.ImprovedAmbushTalent) and 1) or (1413 -(447 + 966))) + ((v11(v29.BroadsideBuff) and 1) or (0 -0))))) and (v37>=(1867 -(1703 + 114))) ;v31.FinishCondition=v34>=((v35-(702 -(376 + 325))) -((((v36 and v20(v29.CrackshotTalent)) or ((v20(v29.HandOfFateTalent) or v20(v29.UnseenBladeTalent)) and v20(v29.HiddenOpportunityTalent) and (v11(v29.AudacityBuff) or v11(v29.OpportunityBuff)))) and (1 -0)) or (0 -0))) ;v31.BuffsAbovePandemic=(((v5("player",v29.BroadsideBuff)>39) and (1 + 0)) or 0) + (((v5("player",v29.RuthlessPrecisionBuff)>(85 -46)) and (15 -(9 + 5))) or (376 -(85 + 291))) + (((v5("player",v29.TrueBearingBuff)>(1304 -(243 + 1022))) and (3 -2)) or (0 + 0)) + (((v5("player",v29.GrandMeleeBuff)>(1219 -(1123 + 57))) and (1 + 0)) or 0) + (((v5("player",v29.BuriedTreasureBuff)>39) and (255 -(163 + 91))) or (1930 -(1869 + 61))) + (((v5("player",v29.SkullAndCrossbonesBuff)>39) and (1 + 0)) or (0 -0)) ;local v55={};if aura_env.config['NeedTarget'] then if ((UnitExists("target")==false) or (UnitCanAttack("player","target")==false)) then local v85=0 -0 ;while true do if (v85==(1 + 0)) then v22("Clear",nil);return;end if (v85==(0 -0)) then WeakAuras.ScanEvents("K_TRIGED_EXTRA",v55);v21("Clear",nil);v85=1 + 0 ;end end end end if (v3(v29.AdrenalineRush) and (( not v11(v29.AdrenalineRush) and ( not v31.FinishCondition or  not v20(v29.ImprovedAdrenalineRushTalent))) or (v11(v29.AdrenalineRushBuff) and (v34<=2) and ((v14(v29.Vanish)<(1475 -(1329 + 145))) or  not ((v32>=2) and v20(v29.HandOfFateTalent)))))) then v55.AdrenalineRush=true;end if (v3(v29.GhostlyStrike) and ((v20(v29.HandOfFateTalent) and ((v14(v29.Vanish)<(972 -(140 + 831))) or  not ((v32>=2) and v20(v29.HandOfFateTalent)))) or (v20(v29.UnseenBladeTalent) and ((v34<v35) or v20(v29.FanTheHammerTalent))))) then v55.GhostlyStrike=true;end if (v3(v29.ThistleTea) and  not v11(v29.ThistleTea) and ((v37<v28) or (v17(1850 -(1409 + 441) ,1717 -(15 + 703) )<(C_Spell.GetSpellCharges(v29.ThistleTea).currentCharges * 6)))) then v55.ThistleTea=true;end if (v3(v29.KeepItRolling) and (((v44>=4) and (v49<=(1 + 1))) or ((v49>=(443 -(262 + 176))) and (v44==(1727 -(345 + 1376)))))) then v55.KeepItRolling=true;end if (v3(v29.KeepItRolling) and (v44>=3) and (v49<=(690 -(198 + 490))) and (v11(v29.BroadsideBuff) or v11(v29.RuthlessPrecisionBuff)) and v11(v29.TrueBearingBuff)) then v55.KeepItRolling=true;end if v3(v29.ColdBlood) then v55.ColdBlood=true;end WeakAuras.ScanEvents("K_TRIGED_EXTRA",v55,nil);local v56=function() if (v3(v29.Ambush) and IsPlayerSpell(v29.HiddenOpportunityTalent) and v11(v29.AudacityBuff)) then v21("Ambush");return true;end if (v3(v29.SinisterStrike) and v39 and  not v36 and  not v20(v29.HiddenOpportunityTalent) and (v9(v29.EscalatingBladeBuff)<(17 -13)) and  not aura_env.HasTww34PcTricksterBuff) then v21("Sinister Strike");return true;end if (v3(v29.PistolShot) and v20(v29.FanTheHammerTalent) and v20(v29.AudacityBuff) and v20(v29.HiddenOpportunityTalent) and v11(v29.OpportunityBuff) and  not v11(v29.AudacityBuff)) then v21("Pistol Shot");return true;end if (v3(v29.BladeFlurry) and v20(v29.DeftManeuversTalent) and (v40>=(9 -5)) and ((v34<=(1208 -(696 + 510))) or  not v11(v29.AdrenalineRushBuff) or  not v20(v29.UnseenBladeTalent))) then local v76=0;while true do if (v76==0) then v21("Blade Flurry");return true;end end end if (v3(v29.BladeFlurry) and v20(v29.DeftManeuversTalent) and ((v35-v34)==(v40 + ((v11(v29.BroadsideBuff) and (1 -0)) or (1262 -(1091 + 171))))) and (v40>=((1 + 2) -((v20(v29.HandOfFateTalent) and (3 -2)) or (0 -0)))) and v20(v29.FanTheHammerTalent)) then local v77=374 -(123 + 251) ;while true do if (0==v77) then v21("Blade Flurry");return true;end end end if (v3(v29.PistolShot) and (v25(v29.FanTheHammerTalentNode)==(9 -7)) and v11(v29.OpportunityBuff) and ((v9(v29.OpportunityBuff)>=((v20(v29.FanTheHammerTalent) and 6) or (699 -(208 + 490)))) or (v5("player",v29.OpportunityBuff)<2))) then local v78=0;while true do if (v78==0) then v21("Pistol Shot");return true;end end end if (v3(v29.PistolShot) and v20(v29.FanTheHammerTalent) and v11(v29.OpportunityBuff) and (((v35-v34)>=(1 + ((((v20(v29.QuickDrawTalent) and (1 + 0)) or (0 + 0)) + ((v11(v29.BroadsideBuff) and (837 -(660 + 176))) or (0 + 0))) * (v25(v29.FanTheHammerTalentNode) + (203 -(14 + 188)))))) or (v34<=((v20(v29.RuthlessnessTalent) and (676 -(534 + 141))) or (0 + 0))))) then v21("Pistol Shot");return true;end if (v3(v29.PistolShot) and  not v20(v29.FanTheHammerTalent) and v11(v29.OpportunityBuff) and (((v38-v37)>(67 + 8)) or ((v35-v34)<=(1 + 0 + ((v11(v29.BroadsideBuff) and 1) or (0 -0)))) or v20(v29.QuickDrawTalent) or (v20(v29.AudacityBuff) and  not v11(v29.AudacityBuff)))) then local v79=0 -0 ;while true do if (v79==(0 -0)) then v21("Pistol Shot");return true;end end end if ((FindSpellOverrideByID(v29.Dispatch)==v29.CoupDeGrace) and  not v36) then local v80=0;while true do if (v80==(0 + 0)) then v21("Dispatch");return true;end end end if (v3(v29.Ambush) and (v20(v29.HiddenOpportunityTalent))) then v21("Ambush");return true;end if v3(v29.SinisterStrike) then v21("Sinister Strike");return true;end end;local v57=function() if v3(v29.KillingSpree) then if ((aura_env.config[tostring(v29.KillingSpree)]==true) and aura_env.FlagKTrigCD) then v22("Killing Spree");elseif (aura_env.config[tostring(v29.KillingSpree)]~=true) then local v93=0 + 0 ;while true do if (0==v93) then v21("Killing Spree");return true;end end end end if (FindSpellOverrideByID(v29.Dispatch)==v29.CoupDeGrace) then local v81=396 -(115 + 281) ;while true do if (v81==0) then v21("Dispatch");return true;end end end if (v3(v29.BetweenTheEyes) and (v11(v29.RuthlessPrecisionBuff) or (v5("player",v29.BetweenTheEyesBuff)<(9 -5)) or  not v20(v29.HandOfFateTalent)) and ( not v11(v29.GreenskinsWickersBuff) or  not v20(v29.GreenskinsWickersTalent))) then local v82=0 + 0 ;while true do if (v82==(0 -0)) then v21("Between the Eyes");return true;end end end if v3(v29.Dispatch) then local v83=0 -0 ;while true do if ((867 -(550 + 317))==v83) then v21("Dispatch");return true;end end end end;local v58=function() if (v3(v29.Vanish) and (v32>=(2 -0)) and v20(v29.HandOfFateTalent) and v3(v29.GhostlyStrike) and v20(v29.GhostlyStrike)) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then v21("Vanish");return true;end end if (v3(v29.Vanish) and (v20(v29.HandOfFateTalent) or  not v20(v29.KillingSpreeTalent)) and (( not v3(v29.BetweenTheEyes) and (v5("player",v29.RuthlessPrecisionBuff)>4)) or (GetUnitChargedPowerPoints("player")~=nil)) and ( not ((v32>=(2 -0)) and v20(v29.HandOfFateTalent)) or  not v20(v29.GhostlyStrike))) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then local v94=0 -0 ;while true do if (v94==(285 -(134 + 151))) then v21("Vanish");return true;end end end end if (v3(v29.Vanish) and ((v20(v29.UnseenBladeTalent) and v20(v29.KillingSpreeTalent) and (v7(v29.KillingSpree)>(1695 -(970 + 695))) and ((v2-aura_env.LastCoupDeGrace)<=10)) or  not (v32>=(7 -3)))) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then local v95=1990 -(582 + 1408) ;while true do if (v95==(0 -0)) then v21("Vanish");return true;end end end end if (v3(v29.Vanish) and (((v16(v29.Vanish)<(18 -3)) and ( not ((v32>=(7 -5)) and v20(v29.HandOfFateTalent)) or  not v20(v29.GhostlyStrike))) or (v18(1884 -(1195 + 629) ,v41)<(v14(v29.Vanish) * (10 -2))))) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then local v96=241 -(187 + 54) ;while true do if ((780 -(162 + 618))==v96) then v21("Vanish");return true;end end end end end;local v59=function() local v66=0 + 0 ;while true do if (v66==(0 + 0)) then if (v3(v29.RollTheBones) and ((v33>=(8 -4)) or v20(v29.SleightOfHandTalent) or v20(v29.SuperchargerTalent)) and (v47<=1) and ((v31.BuffsAbovePandemic<(8 -3)) or (v45<42) or (v33<4))) then local v86=0 + 0 ;while true do if (v86==(1636 -(1373 + 263))) then v21("Roll the Bones");return true;end end end if (v3(v29.RollTheBones) and ((v33>=4) or (v20(v29.SuperchargerTalent) and (v11(v29.LoadedDiceBuff) or (v20(v29.SleightOfHandTalent) and  not v20(v29.KeepItRollingTalent))))) and (v44<=(1002 -(451 + 549)))) then local v87=0;while true do if (v87==0) then v21("Roll the Bones");return true;end end end v66=1 + 0 ;end if (v66==(1 -0)) then if (v3(v29.RollTheBones) and (v33>=(6 -2)) and (v47<(1389 -(746 + 638))) and ((v45<11) or  not v20(v29.KeepItRollingTalent))) then local v88=0;while true do if (v88==0) then v21("Roll the Bones");return true;end end end if (v3(v29.RollTheBones) and  not (v33>=(2 + 2)) and  not v20(v29.KeepItRollingTalent) and  not v20(v29.SuperchargerTalent) and v11(v29.LoadedDiceBuff) and (v44<=(2 -0)) and  not v11(v29.BroadsideBuff) and  not v11(v29.RuthlessPrecisionBuff) and  not v11(v29.TrueBearingBuff)) then local v89=341 -(218 + 123) ;while true do if (v89==0) then v21("Roll the Bones");return true;end end end break;end end end;local v60=function() if (v3(v29.BladeFlurry) and (v40>=2) and (v5("player",v29.BladeFlurry)<v26)) then v21("Blade Flurry");return true;end if v59() then return true;end if (v3(v29.Vanish) and v20(v29.UnderhandedUpperHandTalent) and v20(v29.SubterfugeTalent) and v11(v29.AdrenalineRushBuff) and  not v36 and (v5("player",v29.AdrenalineRushBuff)<(1583 -(1535 + 46))) and (v7(v29.AdrenalineRush)>30)) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then v21("Vanish");return true;end end if ( not v36 and ((v3(v29.KillingSpree) and v20(v29.KillingSpreeTalent)) or (v9(v29.EscalatingBladeBuff)>=(4 + 0)) or aura_env.HasTww34PcTricksterBuff) and v31.FinishCondition) then v57();return true;end if ( not v36 and v20(v29.CrackshotTalent) and v20(v29.UnderhandedUpperHandTalent) and v20(v29.SubterfugeTalent) and ((v11(v29.AdrenalineRushBuff) and v31.FinishCondition and ( not v3(v29.AdrenalineRush) or  not ((v32>=2) and v20(v29.HandOfFateTalent)))) or ((v32>=(1 + 1)) and v20(v29.HandOfFateTalent) and v3(v29.AdrenalineRush) and (v34<=2)))) then if v58() then return true;end end if (v3(v29.Vanish) and  not v36 and (v31.FinishCondition or  not v20(v29.CrackshotTalent)) and ( not v20(v29.UnderhandedUpperHandTalent) or  not v20(v29.SubterfugeTalent) or  not v20(v29.CrackshotTalent)) and ((v11(v29.AdrenalineRushBuff) and v20(v29.SubterfugeTalent) and v20(v29.UnderhandedUpperHandTalent)) or (( not v20(v29.SubterfugeTalent) or  not v20(v29.UnderhandedUpperHandTalent)) and v20(v29.HiddenOpportunityTalent) and  not v11(v29.AudacityBuff) and (v9(v29.OpportunityBuff)<((v20(v29.FanTheHammerTalent) and 6) or (561 -(306 + 254)))) and v31.AmbushCondition) or ( not v20(v29.HiddenOpportunityTalent) and (v20(v29.TakeEmBySurpriseTalent) or v20(v29.DoubleJeopardyTalent))))) then if ((aura_env.config[tostring(v29.Vanish)]==true) and aura_env.FlagKTrigCD) then v22("Vanish");elseif (aura_env.config[tostring(v29.Vanish)]~=true) then v21("Vanish");return true;end end if (v3(v29.BladeRush) and (v37<v27) and  not v36) then local v84=0 + 0 ;while true do if (v84==(0 -0)) then v21("Blade Rush");return true;end end end end;local v61=function() local v67=1467 -(899 + 568) ;while true do if (v67==(0 + 0)) then if (v3(v29.BetweenTheEyes) and v31.FinishCondition and v20(v29.CrackshotTalent) and ( not v11(v29.Shadowmeld) or v36)) then v21("Between the Eyes");return true;end if (v3(v29.Dispatch) and v31.FinishCondition) then local v90=0 -0 ;while true do if (v90==(603 -(268 + 335))) then v21("Dispatch");return true;end end end v67=291 -(60 + 230) ;end if (v67==(573 -(426 + 146))) then if (v3(v29.PistolShot) and v20(v29.CrackshotTalent) and (v25(v29.FanTheHammerTalentNode)>(1 + 0)) and (v9(v29.OpportunityBuff)>=(1462 -(282 + 1174))) and ((v11(v29.BroadsideBuff) and (v34<=(812 -(569 + 242)))) or v11(v29.GreenskinsWickersBuff))) then local v91=0 -0 ;while true do if (v91==(0 + 0)) then v21("Pistol Shot");return true;end end end if (v3(v29.Ambush) and (v20(v29.HiddenOpportunityTalent))) then local v92=0;while true do if (v92==(1024 -(706 + 318))) then v21("Ambush");return true;end end end break;end end end;if v60() then return true;end if v36 then if v61() then return true;end end if v31.FinishCondition then local v74=0;while true do if (v74==(1251 -(721 + 530))) then v57();return true;end end end if v56() then return true;end v21("Clear");end;